"$schema"   = "http://cyaninc.com/json-schemas/tosca-lite-v1/definition-module#"
title       = "Compliance"
package     = charter
version     = "1.0"
description = """
This document defines the new Factory Methodology for Compliance Products
Products such as Service Mapper, Disconnect Mapper, etc...
"""
authors     = [ "Robert Saunders Jr (robert.j.saunders@charter.com)"]

imports {

}

resourceTypes {
    Compliance {
        derivedFrom = charter.resourceTypes.BaseResource
        title = Compliance
        description = """
        Factory for Compliance related products. Mapping services such as disconnects and service
        """

        properties {
            circuit_id {
                title = "Circuit ID"
                description = "Circuit ID"
                type = string
                optional = false
                updatable = false
            }
            device_properties {
                title = "Device Properties"
                description = "Device Management IP, MediaType and placeholder for future properties to be mapped"
                type = object
                config = true
                optional = true
                items.type = object
            }
            compliance_type {
                title = "Service Type"
                description = "The type of service to run"
                type = string
                optional = true
                updatable = false
            }
            service_differences {
                title = "Service Differences"
                description = "Differences of TPEs/FREs"
                type = object
                config = false
                optional = true
                items.type = object
            }
            remediation_flag {
                title = "Remediation Flag"
                description = "Remediation flag for non-service impacting differences"
                type = boolean
                optional = true
                updatable = true
                default = false
            }
            slm_eligible {
                title = "SLM Eligible"
                description = "Circuit is eligible for SLM configuration"
                type = boolean
                optional = true
            }
            slm_traffic_passing {
                title = "SLM Traffic Passing"
                description = "SLM traffic is passing bidirectionally"
                type = boolean
                output = true
                optional = true
            }
            service_type {
                title = "Service Type"
                description = "Network Service Type (FIA, ELINE, ELAN, etc)"
                type = string
                updatable = true
                optional = true
            }
            circuit_details {
                title = "Circuit Details"
                description = "circuit details"
                type = object
                config = false
                optional = true
            }
             cpe_swap {
                title = "CPE Swap"
                description = "Details about swapped CPE if shelf swap detected"
                type = object
                updatable = true
                optional = true
            }
            cpe_swap_note {
                title = "CPE Swap Note"
                description = "Salesforce note for CPE swap reporting"
                type = string
                updatable = true
                optional = true
            }
            circuit_details_id {
                title = "Circuit Details ID"
                description = "circuit details id"
                type = string
                config = false
                optional = true
                updatable = true
            }
            order_type {
                title = "SEEFA Order Type"
                description = "NEW or CHANGE"
                type = string
                optional = true
                enum = ["NEW", "CHANGE"]
            }
        }
    }
}

serviceTemplates {
    Compliance {
        title = Compliance
        description = "Compliance"
        implements = charter.resourceTypes.Compliance

        plans {

            activate {
                type = remote
                language = python
                path = "scripts.fabricator.compliance.Activate"
            }
            terminate {
                type = remote
                language = python
                path = "scripts.fabricator.compliance.Terminate"
            }
        }
    }
}
