"$schema"     ="http://cyaninc.com/json-schemas/tosca-lite-v1/definition-module#"
title       = "Provisioning"
package     = charter
version     = "1.0"
description = """
This document defines the Provisioning Factory model. This is the parent resource
that supports multi-leg circuit provisioning by creating appropriate network service
child resources for each circuit leg.
"""
authors     = [ "Derrick Golden (derrick.golden@charter.com)" ]

imports {

}

resourceTypes {
    Provisioning {
        derivedFrom = [ tosca.resourceTypes.Root, charter.resourceTypes.BaseResource ]
        title = Provisioning
        description = """
        - Parent resource for multi-leg network service provisioning
        - Creates circuit details collector resource when needed
        - Creates 1 to N network service resources based on circuit legs
        - Manages relationships and error propagation between parent and children
        """
        properties {

            circuit_id {
                title = "Circuit ID"
                description = "Circuit ID from the Granite system"
                type = string
                updatable = false
            }

            circuit_details_id {
                title = "Circuit Details ID"
                description = ""
                type = string
                updatable = true
                optional = true
            }

            use_alternate_circuit_details_server {
                title = "Use Alternate Circuit Details Server"
                description = "Flag to use alternate circuit details server"
                type = boolean
                optional = true
                updatable = false
                default = false
            }
            operation_type {
                title = "Operation Type"
                description = "Type of provisioning operation"
                type = string
                optional = true
                updatable = false
                default = "CREATE"
                enum = [
                    "CREATE",
                    "UPDATE",
                    "DELETE"
                ]
            }

            circuit_details_id {
                title = "Circuit Details ID"
                description = "Resource ID of the circuit details (if provided)"
                type = string
                optional = true
                updatable = false
            }
            bandwidth {
                title = bandwidth
                description = "indicates if its a bandwidth update"
                type = boolean
                optional = true
                default = false
            }

            bandwidthValue {
                title = optional bandwidth value
                description = "optional parameter to update bandwidth"
                type = string
                optional = true
            }

            description {
                title = description
                description = "indicates if its a description update"
                type = boolean
                optional = true
                default = false
            }

            ip {
                title = ip
                description = "indicates if its a ip update"
                type = boolean
                optional = true
                default = false
            }

            serviceStateenable {
                title = description
                description = "indicates if its a serviceState enable"
                type = boolean
                default = false

            }

            serviceStatedisable {
                title = description
                description = "indicates if its a serviceState disable"
                type = boolean
                default = false

            }
        }
    }
}

serviceTemplates {
    Provisioning {
        title = Provisioning
        description = "Provisioning for multi-leg network service management"
        implements = charter.resourceTypes.Provisioning

        plans {
            activate {
                type = remote
                language = python
                path = "scripts.fabricator.provisioning.Activate"
            }

            terminate {
                type = remote
                language = python
                path = "scripts.fabricator.provisioning.Terminate"
            }
        }
    }
}