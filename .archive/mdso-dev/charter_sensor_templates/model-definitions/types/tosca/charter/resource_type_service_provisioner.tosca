"$schema"   = "http://cyaninc.com/json-schemas/tosca-lite-v1/definition-module#"
title       = "Service Provisioner"
package     = charter
version     = "1.0"
description = """
This document defines the the Service Provisioner that gets called to 
provision either the entire service or the CPE/PE Portions
"""
authors     = [ "Matt Becker (mbecker@ciena.com)" ]

imports {

}

resourceTypes { 
    ServiceProvisioner {
        derivedFrom = charter.resourceTypes.BaseResource
        title = Service Provisioner
        description = """
        - Extended from charter.resourceTypes.BaseResource 
        - This resource will translate the circuit details object information into the 
        MEF Model and then call cal the MEF Templates
        """

        properties {
        
            stage {
                title = "Stage"
                description = """
                This provides an indication to the resources what stage of activity the resource is in:
                PRODUCTION: Resources are being deployed to production.
                TEST: The orchestration is being done in a test mode
                DISCOVERY: The orchestration steps are being done based on the discovery
                """
                type = string
                optional = true
                updatable = false
                default = "TEST"
                enum = [
                    "PRODUCTION",
                    "TEST",
                    "DISCOVERY"
                ]
            }

            operation {
                title = "Operation"
                description = """
                Operation being called, default is ACTIVATE
                """
                type = string
                optional = true
                updatable = false
                default = "ACTIVATE"
                enum = [
                    "ACTIVATE",
                    "UPDATE",
                    "TERMINATE"
                ]
            }

            update_property {
                title = "Update Property"
                description = "Properties to be updated, only when the operation is UPDATE"
                type = string
                optional = true
                enum = [
                    "bandwidth",
                    "description",
                    "state_toggle",
                    "ip"
                ]
            }

            circuit_details_id {
                title = "Circuit Details ID"
                description = "ID for the circuit details created from the Granite system"
                type = string
                optional = false
                updatable = false
            }
            
            context {
                title = "Context"
                description = "Context"
                type = string
                updatable = false
                default = "PE"
                enum = [
                    "CPE",
                    "PE",
                    "ALL"
                ]
            }
            
            network_service_resource_id {
                title = "Network Service Resource ID"
                description = "Associated Network Service Resource ID "
                type = string
                optional = true
                updatable = false
            }

        }

        requirements {
    
        }
    
        capabilities {
    
        }

    }
}

serviceTemplates {

    ServiceProvisioner {
        title = Service Provisioner
        description = "Service Provisioner"
        implements = charter.resourceTypes.ServiceProvisioner
        
        plans {

            activate {
                type = remote
                language = python
                path = "scripts.networkservice.serviceprovisioner.Activate"
            }
            
        }
    }
}