"$schema"   = "http://cyaninc.com/json-schemas/tosca-lite-v1/definition-module#"
title       = "Circuit Details Collector"
package     = charter
version     = "1.0"
description = """
This document defines the the Circuit Details Collector action that will
go to Granite and create a CircuitDetails object
"""
authors     = [ "Matt Becker (mbecker@ciena.com)" ]

imports {

}

resourceTypes {
    CircuitDetailsCollector {
        derivedFrom = charter.resourceTypes.BaseResource
        title = Circuit Details Collector
        description = """
        - Extended from charter.resourceTypes.BaseResource
        -
        """

        properties {

            leg_details_ids {
                title = "Circuit Details ID's"
                description = "List of all Circuit ID's Created"
                type = array
                items.type = string
                output = true
            }

            circuit_details_id {
                title = "Circuit Details ID"
                description = "ID for the circuit details created from the Granite system"
                type = string
                output = true
            }

            stage {
                title = "Stage"
                description = """
                This provides an indication to the resources what stage of activity the resource is in:
                PRODUCTION: Resources are being deployed to production.
                TEST: The orchestration is being done in a test mode
                DISCOVERY: The orchestration steps are being done based on the discovery
                """
                type = string
                optional = true
                updatable = false
                default = "PRODUCTION"
                enum = [
                    "PRODUCTION",
                    "TEST",
                    "DISCOVERY"
                ]
            }

            network_service_resource_id {
                title = "Network Service Resource ID"
                description = "Network Service Resource ID"
                type = string
                updatable = false
                optional = true
            }

            operation {
                title = "Operation from which this CircuitDetailsCollector was invoked"
                description = """
                This property influences the CircuitDetailsCollector's behavior when choosing which
                nodes to configure.
                """
                optional = true
                updatable = false
                type = string
                default = "NETWORK_SERVICE_ACTIVATION"
                enum = [
                    "NETWORK_SERVICE_UPDATE",
                    "NETWORK_SERVICE_DELETION",
                    "NETWORK_SERVICE_ACTIVATION",
                    "CPE_ACTIVATION",
                    "SERVICE_MAPPER",
                    "SLM",
                    "IP_GETTER",
                    "DISCONNECT_MAPPER",
                    "CONFIG_MODELER",
                    "TRANSPORT",
                    "SMOKE_TEST",
                    "DEVICE_RESET"
                ]
            }

        }

        requirements {

        }

        capabilities {

        }

    }
}

serviceTemplates {

    CircuitDetailsCollector {
        title = Circuit Details Collector
        description = "Circuit Details Collector"
        implements = charter.resourceTypes.CircuitDetailsCollector

        plans {

            activate {
                type = remote
                language = python
                path = "scripts.networkservice.circuitdetailscollector.Activate"
            }

        }

        output = {
          circuit_details_id = { getAttr = [ activate, circuit_details_id ] }
          leg_details_ids = { getAttr = [ activate, leg_details_ids ] }
        }

    }
}
