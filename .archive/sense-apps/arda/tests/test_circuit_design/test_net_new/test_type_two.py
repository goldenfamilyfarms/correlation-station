import logging
import pytest
from copy import deepcopy
from pytest import raises
from arda_app.bll import add_buy_nni as buy
from arda_app.bll import type_two_transport_path as tp

from common_sense.common.errors import AbortException

logger = logging.getLogger(__name__)


@pytest.mark.unittest
def test_add_buy_nni(monkeypatch: pytest.MonkeyPatch):
    test_type_two_payload = {
        "cid": "92.L1XX.004050..CHTR",
        "third_party_provided_circuit": "Y",
        "service_provider": "COMCAST / Comcast",
        "service_provider_uni_cid": "70.KGGS.021142..CPBL..",
        "service_provider_cid": "70.VLXP.019925.ON.CPBL..",
        "service_provider_vlan": "3991",
        "spectrum_buy_nni_circuit_id": "60.KGFD.000001..TWCC",
    }
    path_elements = [
        {"CIRC_PATH_INST_ID": "2511364", "PATH_NAME": "60.KGFD.000001..TWCC"},
        {"CIRC_PATH_INST_ID": "2511364", "PATH_NAME": "60.KGFD.000001..TWCC"},
    ]
    path_elements_parent = []
    buy_nni_exist = True
    responses_get = iter([path_elements, path_elements_parent])
    add_buy_nni_data = {
        "CIRC_PATH_INST_ID": "2330803",
        "CIRCUIT_NAME": "92.L1XX.004050..CHTR",
        "CIRCUIT_STATUS": "Auto-Planned",
        "CIRCUIT_BANDWIDTH": "100 Mbps",
        "CIRCUIT_CATEGORY": "ETHERNET",
        "SERVICE_TYPE": "COM-DIA",
        "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
        "ORDER_NUM": "COM-FIA-097610,ENG-03367376",
        "ORDERED": "MAR 14, 2023",
        "IN_SERVICE": "MAR 25, 2023",
        "A_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
        "A_SITE_TYPE": "CUST_OFFNET",
        "A_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
        "A_SITE_REGION": "WEST",
        "A_ADDRESS": "3382 E GILA RIDGE RD",
        "A_CITY": "YUMA",
        "A_STATE": "AZ",
        "A_ZIP": "85365",
        "A_COMMENTS": "ENG-04168855\nCPE Fiber Installer\t\nJose E Morales\nAs Built Demarcation Location\t\n \nManaged Services Installer Type\t\n \nCPE Install Notes\t\n10/19-JM- Install complete. Cradleopint configured.\n\nCradlepoint location: 1st floor IT room, Wall mounted on backboard.",
        "A_CLLI": "YUMAAZQU",
        "A_NPA": "928",
        "A_LONGITUDE": "-114.575279",
        "A_LATITUDE": "32.686742",
        "Z_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
        "Z_SITE_TYPE": "CUST_OFFNET",
        "Z_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
        "Z_SITE_REGION": "WEST",
        "Z_ADDRESS": "3382 E GILA RIDGE RD",
        "Z_CITY": "YUMA",
        "Z_STATE": "AZ",
        "Z_ZIP": "85365",
        "Z_COMMENTS": "ENG-04168855\nCPE Fiber Installer\t\nJose E Morales\nAs Built Demarcation Location\t\n \nManaged Services Installer Type\t\n \nCPE Install Notes\t\n10/19-JM- Install complete. Cradleopint configured.\n\nCradlepoint location: 1st floor IT room, Wall mounted on backboard.",
        "Z_CLLI": "YUMAAZQU",
        "Z_NPA": "928",
        "Z_LONGITUDE": "-114.575279",
        "Z_LATITUDE": "32.686742",
        "LEG_NAME": "1",
        "LEG_INST_ID": "2665424",
    }

    _resequence_dynamic_router_port_data = {
        "pathId": "92.L1XX.004050..CHTR",
        "pathRev": "1",
        "status": "Auto-Planned",
        "pathInstanceId": "2330803",
        "retString": "Path Updated",
    }
    monkeypatch.setattr(buy, "get_path_elements", lambda *_: next(responses_get))
    monkeypatch.setattr(buy, "does_buy_nni_exist", lambda *args, **kwargs: buy_nni_exist)
    monkeypatch.setattr(buy, "oversubscribe_check", lambda *args, **kwargs: None)
    monkeypatch.setattr(buy, "_add_buy_nni_path", lambda *args, **kwargs: add_buy_nni_data)
    monkeypatch.setattr(
        buy, "_resequence_dynamic_router_port", lambda *args, **kwargs: _resequence_dynamic_router_port_data
    )
    data = buy.add_buy_nni(test_type_two_payload)
    assert data is True

    # bad test unable to find path elements for buy NNI
    parent_elements2 = None

    monkeypatch.setattr(buy, "get_path_elements", lambda *_: parent_elements2)

    with raises(AbortException):
        assert buy.add_buy_nni(test_type_two_payload) is None

    # bad test path element parent has elements
    path_elements = [
        {"CIRC_PATH_INST_ID": "2511364", "PATH_NAME": "60.KGFD.000001..TWCC"},
        {"CIRC_PATH_INST_ID": "2511364", "PATH_NAME": "60.KGFD.000001..TWCC"},
    ]

    path_elements_parent = [{"STuff": "element"}, {"more stuff": "element"}]

    responses_get = iter([path_elements, path_elements_parent])

    monkeypatch.setattr(buy, "get_path_elements", lambda *_: next(responses_get))

    with raises(AbortException):
        assert buy.add_buy_nni(test_type_two_payload) is None

    # bad test buy nnit has no data
    path_elements = [
        {"CIRC_PATH_INST_ID": "2511364", "PATH_NAME": "60.KGFD.000001..TWCC"},
        {"CIRC_PATH_INST_ID": "2511364", "PATH_NAME": "60.KGFD.000001..TWCC"},
    ]
    path_elements_parent = []
    responses_get = iter([path_elements, path_elements_parent])
    monkeypatch.setattr(buy, "get_path_elements", lambda *_: next(responses_get))
    monkeypatch.setattr(buy, "does_buy_nni_exist", lambda *args, **kwargs: False)
    monkeypatch.setattr(buy, "oversubscribe_check", lambda *args, **kwargs: None)

    with raises(AbortException):
        assert buy.add_buy_nni(test_type_two_payload) is None

    # bad test no vendor
    path_elements = [
        {"CIRC_PATH_INST_ID": "2511364", "PATH_NAME": "60.KGFD.000001..TWCC", "VENDOR": "TEST"},
        {"CIRC_PATH_INST_ID": "2511364", "PATH_NAME": "60.KGFD.000001..TWCC", "VENDOR": "ADVA"},
    ]
    path_elements_parent = []
    responses_get = iter([path_elements, path_elements_parent])
    monkeypatch.setattr(buy, "get_path_elements", lambda *_: next(responses_get))
    monkeypatch.setattr(buy, "does_buy_nni_exist", lambda *args, **kwargs: True)
    monkeypatch.setattr(buy, "oversubscribe_check", lambda *args, **kwargs: None)

    with raises(AbortException):
        assert buy.add_buy_nni(test_type_two_payload) is None


@pytest.mark.unittest
def test_add_buy_nni_path(monkeypatch: pytest.MonkeyPatch, client):
    cid = "92.L1XX.004050..CHTR"
    buy_nni_path_inst_id = "2511364"
    path_elements_parent = [
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "1.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "1",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": None,
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "CLOUD",
            "ELEMENT_NAME": "CHTRSE.CEN.WEST.MPLS",
            "ELEMENT_REFERENCE": "1129",
            "ELEMENT_CATEGORY": "MPLS",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": None,
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": None,
            "PORT_NAME": None,
            "PORT_INST_ID": None,
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": None,
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": None,
            "VENDOR": None,
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": None,
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        }
    ]
    buy_nni_path_elements = [
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "1.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "1",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA1CW/001.00D.004.01/RTR",
            "ELEMENT_REFERENCE": "503601",
            "ELEMENT_CATEGORY": "ROUTER",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "[0/2]/1",
            "PORT_NAME": "1",
            "PORT_INST_ID": "114433805",
            "PORT_ACCESS_ID": "XE-1/2/1",
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": "DYNAMIC",
            "FQDN": "PHNHAZVA1CW.CHTRSE.COM",
            "MODEL": "MX240",
            "VENDOR": "JUNIPER",
            "TID": "PHNHAZVA1CW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "24.43.180.244/32",
            "IPV6_ADDRESS": "2605:E000::F:8F/128",
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "60.KGFD.000001..TWCC",
            "INITIAL_CIRCUIT_ID": "2511364",
            "LVL": "1",
        }
    ]
    granite_response_data = {"retString": "path updated"}
    response = {
        "CIRC_PATH_INST_ID": "2330803",
        "CIRCUIT_NAME": "92.L1XX.004050..CHTR",
        "CIRCUIT_STATUS": "Live",
        "CIRCUIT_BANDWIDTH": "100 Mbps",
        "CIRCUIT_CATEGORY": "ETHERNET",
        "SERVICE_TYPE": "COM-DIA",
        "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
        "ORDER_NUM": "COM-FIA-097610,ENG-03367376",
        "ORDERED": "MAR 14, 2023",
        "IN_SERVICE": "MAR 25, 2023",
        "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
        "A_SITE_TYPE": "COLO",
        "A_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
        "A_SITE_REGION": "WEST",
        "A_ADDRESS": "615 N 48TH ST",
        "A_CITY": "PHOENIX",
        "A_STATE": "AZ",
        "A_ZIP": "85008",
        "A_FLOOR": "1",
        "A_ROOM": "D",
        "A_CLLI": "PHNHAZVA",
        "A_NPA": "602",
        "A_LONGITUDE": "-111.977644",
        "A_LATITUDE": "33.455597",
        "Z_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
        "Z_SITE_TYPE": "CUST_OFFNET",
        "Z_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
        "Z_SITE_REGION": "WEST",
        "Z_ADDRESS": "3382 E GILA RIDGE RD",
        "Z_CITY": "YUMA",
        "Z_STATE": "AZ",
        "Z_ZIP": "85365",
        "Z_COMMENTS": "ENG-04168855\nCPE Fiber Installer\t\nJose E Morales\nAs Built Demarcation Location\t\n \nManaged Services Installer Type\t\n \nCPE Install Notes\t\n10/19-JM- Install complete. Cradleopint configured.\n\nCradlepoint location: 1st floor IT room, Wall mounted on backboard.",
        "Z_CLLI": "YUMAAZQU",
        "Z_NPA": "928",
        "Z_LONGITUDE": "-114.575279",
        "Z_LATITUDE": "32.686742",
        "LEG_NAME": "1",
        "LEG_INST_ID": "2665424",
    }
    res_data = [
        {
            "CIRC_PATH_INST_ID": "2330803",
            "CIRCUIT_NAME": "92.L1XX.004050..CHTR",
            "CIRCUIT_STATUS": "Live",
            "CIRCUIT_BANDWIDTH": "100 Mbps",
            "CIRCUIT_CATEGORY": "ETHERNET",
            "SERVICE_TYPE": "COM-DIA",
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "ORDER_NUM": "COM-FIA-097610,ENG-03367376",
            "ORDERED": "MAR 14, 2023",
            "IN_SERVICE": "MAR 25, 2023",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_SITE_TYPE": "COLO",
            "A_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
            "A_SITE_REGION": "WEST",
            "A_ADDRESS": "615 N 48TH ST",
            "A_CITY": "PHOENIX",
            "A_STATE": "AZ",
            "A_ZIP": "85008",
            "A_FLOOR": "1",
            "A_ROOM": "D",
            "A_CLLI": "PHNHAZVA",
            "A_NPA": "602",
            "A_LONGITUDE": "-111.977644",
            "A_LATITUDE": "33.455597",
            "Z_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "Z_SITE_TYPE": "CUST_OFFNET",
            "Z_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
            "Z_SITE_REGION": "WEST",
            "Z_ADDRESS": "3382 E GILA RIDGE RD",
            "Z_CITY": "YUMA",
            "Z_STATE": "AZ",
            "Z_ZIP": "85365",
            "Z_COMMENTS": "ENG-04168855\nCPE Fiber Installer\t\nJose E Morales\nAs Built Demarcation Location\t\n \nManaged Services Installer Type\t\n \nCPE Install Notes\t\n10/19-JM- Install complete. Cradleopint configured.\n\nCradlepoint location: 1st floor IT room, Wall mounted on backboard.",
            "Z_CLLI": "YUMAAZQU",
            "Z_NPA": "928",
            "Z_LONGITUDE": "-114.575279",
            "Z_LATITUDE": "32.686742",
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
        }
    ]
    monkeypatch.setattr(buy, "put_granite", lambda *_: granite_response_data)
    monkeypatch.setattr(buy, "get_granite", lambda *_: res_data)
    data = buy._add_buy_nni_path(cid, buy_nni_path_inst_id, path_elements_parent, buy_nni_path_elements)
    assert data == response

    # bad test no put granite data
    monkeypatch.setattr(buy, "put_granite", lambda *_: None)

    with raises(Exception):
        assert buy._add_buy_nni_path(cid, buy_nni_path_inst_id, path_elements_parent, buy_nni_path_elements) is None

    # bad test retString not equal to path updated
    granite_response_data = {"retString": "not updated"}
    monkeypatch.setattr(buy, "put_granite", lambda *_: granite_response_data)

    with raises(Exception):
        assert buy._add_buy_nni_path(cid, buy_nni_path_inst_id, path_elements_parent, buy_nni_path_elements) is None


@pytest.mark.unittest
def test_does_buy_nni_exist():
    buy_nni_path_elements = [
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "1.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "1",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA1CW/001.00D.004.01/RTR",
            "ELEMENT_REFERENCE": "503601",
            "ELEMENT_CATEGORY": "ROUTER",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "[0/2]/1",
            "PORT_NAME": "1",
            "PORT_INST_ID": "114433805",
            "PORT_ACCESS_ID": "XE-1/2/1",
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": "DYNAMIC",
            "FQDN": "PHNHAZVA1CW.CHTRSE.COM",
            "MODEL": "MX240",
            "VENDOR": "JUNIPER",
            "TID": "PHNHAZVA1CW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "24.43.180.244/32",
            "IPV6_ADDRESS": "2605:E000::F:8F/128",
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "60.KGFD.000001..TWCC",
            "INITIAL_CIRCUIT_ID": "2511364",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "2",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA/001.00D.004.42/MMP FDP",
            "ELEMENT_REFERENCE": "504691",
            "ELEMENT_CATEGORY": "FDP",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "OPTICAL",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "5",
            "PORT_NAME": "3",
            "PORT_INST_ID": "83466376",
            "PORT_ACCESS_ID": "27",
            "CONNECTOR_TYPE": "SC-UPC",
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": "ASBMMB1021480",
            "VENDOR": "ALL SYSTEMS BROADBAND",
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "60.KGFD.000001..TWCC",
            "INITIAL_CIRCUIT_ID": "2511364",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "3.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "3",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA/001.00D.004.42/MMP FDP",
            "ELEMENT_REFERENCE": "504691",
            "ELEMENT_CATEGORY": "FDP",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "OPTICAL",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "5",
            "PORT_NAME": "4",
            "PORT_INST_ID": "83466377",
            "PORT_ACCESS_ID": "28",
            "CONNECTOR_TYPE": "SC-UPC",
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": "ASBMMB1021480",
            "VENDOR": "ALL SYSTEMS BROADBAND",
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "60.KGFD.000001..TWCC",
            "INITIAL_CIRCUIT_ID": "2511364",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "4.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "4",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "ELEMENT_TYPE": "SEGMENT",
            "ELEMENT_NAME": "1F/KGFN/004238/LVLC",
            "ELEMENT_REFERENCE": "50976",
            "ELEMENT_CATEGORY": "CUSTOMER",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": None,
            "PORT_NAME": None,
            "PORT_INST_ID": None,
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": None,
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": None,
            "VENDOR": None,
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": None,
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "60.KGFD.000001..TWCC",
            "INITIAL_CIRCUIT_ID": "2511364",
            "LVL": "1",
        },
    ]
    assert buy.does_buy_nni_exist(buy_nni_path_elements) is True

    buy_nni_path_elements = []
    assert buy.does_buy_nni_exist(buy_nni_path_elements) is False


@pytest.mark.unittest
def test_buy_nni_device_vendor():
    buy_nni_path_elements = [
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "1.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "1",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA1CW/001.00D.004.01/RTR",
            "ELEMENT_REFERENCE": "503601",
            "ELEMENT_CATEGORY": "ROUTER",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "[0/2]/1",
            "PORT_NAME": "1",
            "PORT_INST_ID": "114433805",
            "PORT_ACCESS_ID": "XE-1/2/1",
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": "DYNAMIC",
            "FQDN": "PHNHAZVA1CW.CHTRSE.COM",
            "MODEL": "MX240",
            "VENDOR": "JUNIPER",
            "TID": "PHNHAZVA1CW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "24.43.180.244/32",
            "IPV6_ADDRESS": "2605:E000::F:8F/128",
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "60.KGFD.000001..TWCC",
            "INITIAL_CIRCUIT_ID": "2511364",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "2",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA/001.00D.004.42/MMP FDP",
            "ELEMENT_REFERENCE": "504691",
            "ELEMENT_CATEGORY": "FDP",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "OPTICAL",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "5",
            "PORT_NAME": "3",
            "PORT_INST_ID": "83466376",
            "PORT_ACCESS_ID": "27",
            "CONNECTOR_TYPE": "SC-UPC",
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": "ASBMMB1021480",
            "VENDOR": "ALL SYSTEMS BROADBAND",
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "60.KGFD.000001..TWCC",
            "INITIAL_CIRCUIT_ID": "2511364",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "3.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "3",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA/001.00D.004.42/MMP FDP",
            "ELEMENT_REFERENCE": "504691",
            "ELEMENT_CATEGORY": "FDP",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "OPTICAL",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "5",
            "PORT_NAME": "4",
            "PORT_INST_ID": "83466377",
            "PORT_ACCESS_ID": "28",
            "CONNECTOR_TYPE": "SC-UPC",
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": "ASBMMB1021480",
            "VENDOR": "ALL SYSTEMS BROADBAND",
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "60.KGFD.000001..TWCC",
            "INITIAL_CIRCUIT_ID": "2511364",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "4.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "4",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "ELEMENT_TYPE": "SEGMENT",
            "ELEMENT_NAME": "1F/KGFN/004238/LVLC",
            "ELEMENT_REFERENCE": "50976",
            "ELEMENT_CATEGORY": "CUSTOMER",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": None,
            "PORT_NAME": None,
            "PORT_INST_ID": None,
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": None,
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": None,
            "VENDOR": None,
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": None,
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "60.KGFD.000001..TWCC",
            "INITIAL_CIRCUIT_ID": "2511364",
            "LVL": "1",
        },
    ]
    assert buy.buy_nni_device_vendor(buy_nni_path_elements) == ""

    buy_nni_path_elements[-1]["VENDOR"] = "ADVA"
    assert buy.buy_nni_device_vendor(buy_nni_path_elements) == "ADVA"


@pytest.mark.unittest
def test_get_cloud_sequence_number():
    path_elements_parent = [
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "1.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "1",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": None,
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "CLOUD",
            "ELEMENT_NAME": "CHTRSE.CEN.WEST.MPLS",
            "ELEMENT_REFERENCE": "1129",
            "ELEMENT_CATEGORY": "MPLS",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": None,
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": None,
            "PORT_NAME": None,
            "PORT_INST_ID": None,
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": None,
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": None,
            "VENDOR": None,
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": None,
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "2",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "ELEMENT_TYPE": "PATH",
            "ELEMENT_NAME": "60.KGFD.000001..TWCC",
            "ELEMENT_REFERENCE": "2511364",
            "ELEMENT_CATEGORY": "ETHERNET TRANSPORT",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": "2190296",
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977382",
            "SLOT": None,
            "PORT_NAME": None,
            "PORT_INST_ID": None,
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": None,
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": None,
            "VENDOR": None,
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": None,
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "3.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "3",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA1CW/001.00D.004.01/RTR",
            "ELEMENT_REFERENCE": "503601",
            "ELEMENT_CATEGORY": "ROUTER",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "100 Mbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "[0/2]/1",
            "PORT_NAME": "1-54",
            "PORT_INST_ID": "116249429",
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": "DYNAMIC",
            "FQDN": "PHNHAZVA1CW.CHTRSE.COM",
            "MODEL": "MX240",
            "VENDOR": "JUNIPER",
            "TID": "PHNHAZVA1CW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "24.43.180.244/32",
            "IPV6_ADDRESS": "2605:E000::F:8F/128",
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "4.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "4",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "ELEMENT_TYPE": "PATH",
            "ELEMENT_NAME": "92001.GE1.PHNHAZVA1CW.YUMAAZQU1ZW",
            "ELEMENT_REFERENCE": "2468478",
            "ELEMENT_CATEGORY": "ETHERNET TRANSPORT",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "1 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "VLAN1110",
            "CHAN_INST_ID": "10977317",
            "SLOT": None,
            "PORT_NAME": None,
            "PORT_INST_ID": None,
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": None,
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": None,
            "VENDOR": None,
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": None,
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "5.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "5",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "YUMAAZQU1ZW/999.9999.999.99/SWT",
            "ELEMENT_REFERENCE": "1754765",
            "ELEMENT_CATEGORY": "SWITCH",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10/100/1000 BASET",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "CHASSIS PORTS",
            "PORT_NAME": "03",
            "PORT_INST_ID": "114961572",
            "PORT_ACCESS_ID": "ACCESS-1-1-1-3",
            "CONNECTOR_TYPE": "RJ-45",
            "PORT_CHANNELIZATION": None,
            "FQDN": "YUMAAZQU1ZW.CML.CHTRSE.COM",
            "MODEL": "FSP 150-GE114PRO-C",
            "VENDOR": "ADVA",
            "TID": "YUMAAZQU1ZW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "10.0.210.177/24",
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": "1110",
            "VLAN_OPERATION": "PUSH",
            "PORT_ROLE": "UNI-EP",
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2..1.",
            "PARENT_SEQUENCE": "2",
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "1",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA1CW/001.00D.004.01/RTR",
            "ELEMENT_REFERENCE": "503601",
            "ELEMENT_CATEGORY": "ROUTER",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977382",
            "SLOT": "[0/2]/1",
            "PORT_NAME": "1",
            "PORT_INST_ID": "114433805",
            "PORT_ACCESS_ID": "XE-1/2/1",
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": "DYNAMIC",
            "FQDN": "PHNHAZVA1CW.CHTRSE.COM",
            "MODEL": "MX240",
            "VENDOR": "JUNIPER",
            "TID": "PHNHAZVA1CW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "24.43.180.244/32",
            "IPV6_ADDRESS": "2605:E000::F:8F/128",
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "2",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2..2.",
            "PARENT_SEQUENCE": "2",
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "2",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA/001.00D.004.42/MMP FDP",
            "ELEMENT_REFERENCE": "504691",
            "ELEMENT_CATEGORY": "FDP",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "OPTICAL",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977382",
            "SLOT": "5",
            "PORT_NAME": "3",
            "PORT_INST_ID": "83466376",
            "PORT_ACCESS_ID": "27",
            "CONNECTOR_TYPE": "SC-UPC",
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": "ASBMMB1021480",
            "VENDOR": "ALL SYSTEMS BROADBAND",
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "2",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2..3.",
            "PARENT_SEQUENCE": "2",
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "3",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA/001.00D.004.42/MMP FDP",
            "ELEMENT_REFERENCE": "504691",
            "ELEMENT_CATEGORY": "FDP",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "OPTICAL",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977382",
            "SLOT": "5",
            "PORT_NAME": "4",
            "PORT_INST_ID": "83466377",
            "PORT_ACCESS_ID": "28",
            "CONNECTOR_TYPE": "SC-UPC",
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": "ASBMMB1021480",
            "VENDOR": "ALL SYSTEMS BROADBAND",
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "2",
        },
        {
            "CIRC_PATH_INST_ID": "2468478",
            "PATH_NAME": "92001.GE1.PHNHAZVA1CW.YUMAAZQU1ZW",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": None,
            "EVC_ID": None,
            "SERVICE_TYPE": "INT-ACCESS TO PREM TRANSPORT",
            "BANDWIDTH": "1 Gbps",
            "BW_SIZE": "1000000000",
            "CUSTOMER_ID": None,
            "CUSTOMER_NAME": None,
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": None,
            "ORDER_REFERENCE": "4..2.",
            "PARENT_SEQUENCE": "4",
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "2",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2844562",
            "A_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "YUMAAZQU1ZW/999.9999.999.99/SWT",
            "ELEMENT_REFERENCE": "1754765",
            "ELEMENT_CATEGORY": "SWITCH",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "1 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "VLAN1110",
            "CHAN_INST_ID": "10977317",
            "SLOT": "01",
            "PORT_NAME": "1",
            "PORT_INST_ID": "114961569",
            "PORT_ACCESS_ID": "NETWORK-1-1-1-1",
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": None,
            "FQDN": "YUMAAZQU1ZW.CML.CHTRSE.COM",
            "MODEL": "FSP 150-GE114PRO-C",
            "VENDOR": "ADVA",
            "TID": "YUMAAZQU1ZW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "10.0.210.177/24",
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "2",
        },
    ]
    assert buy.get_cloud_sequence_number(path_elements_parent) == "1"


@pytest.mark.unittest
def test_get_buy_nni_sequence_number():
    path_elements_parent = [
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "1.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "1",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": None,
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "CLOUD",
            "ELEMENT_NAME": "CHTRSE.CEN.WEST.MPLS",
            "ELEMENT_REFERENCE": "1129",
            "ELEMENT_CATEGORY": "MPLS",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": None,
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": None,
            "PORT_NAME": None,
            "PORT_INST_ID": None,
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": None,
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": None,
            "VENDOR": None,
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": None,
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "2",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "ELEMENT_TYPE": "PATH",
            "ELEMENT_NAME": "60.KGFD.000001..TWCC",
            "ELEMENT_REFERENCE": "2511364",
            "ELEMENT_CATEGORY": "ETHERNET TRANSPORT",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": "2190296",
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977382",
            "SLOT": None,
            "PORT_NAME": None,
            "PORT_INST_ID": None,
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": None,
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": None,
            "VENDOR": None,
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": None,
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "3.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "3",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA1CW/001.00D.004.01/RTR",
            "ELEMENT_REFERENCE": "503601",
            "ELEMENT_CATEGORY": "ROUTER",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "100 Mbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "[0/2]/1",
            "PORT_NAME": "1-54",
            "PORT_INST_ID": "116249429",
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": "DYNAMIC",
            "FQDN": "PHNHAZVA1CW.CHTRSE.COM",
            "MODEL": "MX240",
            "VENDOR": "JUNIPER",
            "TID": "PHNHAZVA1CW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "24.43.180.244/32",
            "IPV6_ADDRESS": "2605:E000::F:8F/128",
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "4.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "4",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "ELEMENT_TYPE": "PATH",
            "ELEMENT_NAME": "92001.GE1.PHNHAZVA1CW.YUMAAZQU1ZW",
            "ELEMENT_REFERENCE": "2468478",
            "ELEMENT_CATEGORY": "ETHERNET TRANSPORT",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "1 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "VLAN1110",
            "CHAN_INST_ID": "10977317",
            "SLOT": None,
            "PORT_NAME": None,
            "PORT_INST_ID": None,
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": None,
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": None,
            "VENDOR": None,
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": None,
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "5.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "5",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "YUMAAZQU1ZW/999.9999.999.99/SWT",
            "ELEMENT_REFERENCE": "1754765",
            "ELEMENT_CATEGORY": "SWITCH",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10/100/1000 BASET",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "CHASSIS PORTS",
            "PORT_NAME": "03",
            "PORT_INST_ID": "114961572",
            "PORT_ACCESS_ID": "ACCESS-1-1-1-3",
            "CONNECTOR_TYPE": "RJ-45",
            "PORT_CHANNELIZATION": None,
            "FQDN": "YUMAAZQU1ZW.CML.CHTRSE.COM",
            "MODEL": "FSP 150-GE114PRO-C",
            "VENDOR": "ADVA",
            "TID": "YUMAAZQU1ZW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "10.0.210.177/24",
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": "1110",
            "VLAN_OPERATION": "PUSH",
            "PORT_ROLE": "UNI-EP",
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2..1.",
            "PARENT_SEQUENCE": "2",
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "1",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA1CW/001.00D.004.01/RTR",
            "ELEMENT_REFERENCE": "503601",
            "ELEMENT_CATEGORY": "ROUTER",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977382",
            "SLOT": "[0/2]/1",
            "PORT_NAME": "1",
            "PORT_INST_ID": "114433805",
            "PORT_ACCESS_ID": "XE-1/2/1",
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": "DYNAMIC",
            "FQDN": "PHNHAZVA1CW.CHTRSE.COM",
            "MODEL": "MX240",
            "VENDOR": "JUNIPER",
            "TID": "PHNHAZVA1CW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "24.43.180.244/32",
            "IPV6_ADDRESS": "2605:E000::F:8F/128",
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "2",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2..2.",
            "PARENT_SEQUENCE": "2",
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "2",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA/001.00D.004.42/MMP FDP",
            "ELEMENT_REFERENCE": "504691",
            "ELEMENT_CATEGORY": "FDP",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "OPTICAL",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977382",
            "SLOT": "5",
            "PORT_NAME": "3",
            "PORT_INST_ID": "83466376",
            "PORT_ACCESS_ID": "27",
            "CONNECTOR_TYPE": "SC-UPC",
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": "ASBMMB1021480",
            "VENDOR": "ALL SYSTEMS BROADBAND",
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "2",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2..3.",
            "PARENT_SEQUENCE": "2",
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "3",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA/001.00D.004.42/MMP FDP",
            "ELEMENT_REFERENCE": "504691",
            "ELEMENT_CATEGORY": "FDP",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "OPTICAL",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977382",
            "SLOT": "5",
            "PORT_NAME": "4",
            "PORT_INST_ID": "83466377",
            "PORT_ACCESS_ID": "28",
            "CONNECTOR_TYPE": "SC-UPC",
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": "ASBMMB1021480",
            "VENDOR": "ALL SYSTEMS BROADBAND",
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "2",
        },
        {
            "CIRC_PATH_INST_ID": "2468478",
            "PATH_NAME": "92001.GE1.PHNHAZVA1CW.YUMAAZQU1ZW",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": None,
            "EVC_ID": None,
            "SERVICE_TYPE": "INT-ACCESS TO PREM TRANSPORT",
            "BANDWIDTH": "1 Gbps",
            "BW_SIZE": "1000000000",
            "CUSTOMER_ID": None,
            "CUSTOMER_NAME": None,
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": None,
            "ORDER_REFERENCE": "4..2.",
            "PARENT_SEQUENCE": "4",
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "2",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2844562",
            "A_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "YUMAAZQU1ZW/999.9999.999.99/SWT",
            "ELEMENT_REFERENCE": "1754765",
            "ELEMENT_CATEGORY": "SWITCH",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "1 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "VLAN1110",
            "CHAN_INST_ID": "10977317",
            "SLOT": "01",
            "PORT_NAME": "1",
            "PORT_INST_ID": "114961569",
            "PORT_ACCESS_ID": "NETWORK-1-1-1-1",
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": None,
            "FQDN": "YUMAAZQU1ZW.CML.CHTRSE.COM",
            "MODEL": "FSP 150-GE114PRO-C",
            "VENDOR": "ADVA",
            "TID": "YUMAAZQU1ZW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "10.0.210.177/24",
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "2",
        },
    ]
    assert buy.get_buy_nni_sequence_number(path_elements_parent) == "2"


@pytest.mark.unittest
def test_get_dynamic_router_port_sequence_number():
    path_elements_parent = [
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "1.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "1",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": None,
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "CLOUD",
            "ELEMENT_NAME": "CHTRSE.CEN.WEST.MPLS",
            "ELEMENT_REFERENCE": "1129",
            "ELEMENT_CATEGORY": "MPLS",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": None,
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": None,
            "PORT_NAME": None,
            "PORT_INST_ID": None,
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": None,
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": None,
            "VENDOR": None,
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": None,
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "2",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "ELEMENT_TYPE": "PATH",
            "ELEMENT_NAME": "60.KGFD.000001..TWCC",
            "ELEMENT_REFERENCE": "2511364",
            "ELEMENT_CATEGORY": "ETHERNET TRANSPORT",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": "2190296",
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977382",
            "SLOT": None,
            "PORT_NAME": None,
            "PORT_INST_ID": None,
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": None,
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": None,
            "VENDOR": None,
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": None,
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "3.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "3",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA1CW/001.00D.004.01/RTR",
            "ELEMENT_REFERENCE": "503601",
            "ELEMENT_CATEGORY": "ROUTER",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "100 Mbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "[0/2]/1",
            "PORT_NAME": "1-54",
            "PORT_INST_ID": "116249429",
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": "DYNAMIC",
            "FQDN": "PHNHAZVA1CW.CHTRSE.COM",
            "MODEL": "MX240",
            "VENDOR": "JUNIPER",
            "TID": "PHNHAZVA1CW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "24.43.180.244/32",
            "IPV6_ADDRESS": "2605:E000::F:8F/128",
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "4.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "4",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "ELEMENT_TYPE": "PATH",
            "ELEMENT_NAME": "92001.GE1.PHNHAZVA1CW.YUMAAZQU1ZW",
            "ELEMENT_REFERENCE": "2468478",
            "ELEMENT_CATEGORY": "ETHERNET TRANSPORT",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "1 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "VLAN1110",
            "CHAN_INST_ID": "10977317",
            "SLOT": None,
            "PORT_NAME": None,
            "PORT_INST_ID": None,
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": None,
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": None,
            "VENDOR": None,
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": None,
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "5.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "5",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "YUMAAZQU1ZW/999.9999.999.99/SWT",
            "ELEMENT_REFERENCE": "1754765",
            "ELEMENT_CATEGORY": "SWITCH",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10/100/1000 BASET",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "CHASSIS PORTS",
            "PORT_NAME": "03",
            "PORT_INST_ID": "114961572",
            "PORT_ACCESS_ID": "ACCESS-1-1-1-3",
            "CONNECTOR_TYPE": "RJ-45",
            "PORT_CHANNELIZATION": None,
            "FQDN": "YUMAAZQU1ZW.CML.CHTRSE.COM",
            "MODEL": "FSP 150-GE114PRO-C",
            "VENDOR": "ADVA",
            "TID": "YUMAAZQU1ZW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "10.0.210.177/24",
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": "1110",
            "VLAN_OPERATION": "PUSH",
            "PORT_ROLE": "UNI-EP",
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2..1.",
            "PARENT_SEQUENCE": "2",
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "1",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA1CW/001.00D.004.01/RTR",
            "ELEMENT_REFERENCE": "503601",
            "ELEMENT_CATEGORY": "ROUTER",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977382",
            "SLOT": "[0/2]/1",
            "PORT_NAME": "1",
            "PORT_INST_ID": "114433805",
            "PORT_ACCESS_ID": "XE-1/2/1",
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": "DYNAMIC",
            "FQDN": "PHNHAZVA1CW.CHTRSE.COM",
            "MODEL": "MX240",
            "VENDOR": "JUNIPER",
            "TID": "PHNHAZVA1CW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "24.43.180.244/32",
            "IPV6_ADDRESS": "2605:E000::F:8F/128",
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "2",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2..2.",
            "PARENT_SEQUENCE": "2",
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "2",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA/001.00D.004.42/MMP FDP",
            "ELEMENT_REFERENCE": "504691",
            "ELEMENT_CATEGORY": "FDP",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "OPTICAL",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977382",
            "SLOT": "5",
            "PORT_NAME": "3",
            "PORT_INST_ID": "83466376",
            "PORT_ACCESS_ID": "27",
            "CONNECTOR_TYPE": "SC-UPC",
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": "ASBMMB1021480",
            "VENDOR": "ALL SYSTEMS BROADBAND",
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "2",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2..3.",
            "PARENT_SEQUENCE": "2",
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "3",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA/001.00D.004.42/MMP FDP",
            "ELEMENT_REFERENCE": "504691",
            "ELEMENT_CATEGORY": "FDP",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "OPTICAL",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977382",
            "SLOT": "5",
            "PORT_NAME": "4",
            "PORT_INST_ID": "83466377",
            "PORT_ACCESS_ID": "28",
            "CONNECTOR_TYPE": "SC-UPC",
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": "ASBMMB1021480",
            "VENDOR": "ALL SYSTEMS BROADBAND",
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "2",
        },
        {
            "CIRC_PATH_INST_ID": "2468478",
            "PATH_NAME": "92001.GE1.PHNHAZVA1CW.YUMAAZQU1ZW",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": None,
            "EVC_ID": None,
            "SERVICE_TYPE": "INT-ACCESS TO PREM TRANSPORT",
            "BANDWIDTH": "1 Gbps",
            "BW_SIZE": "1000000000",
            "CUSTOMER_ID": None,
            "CUSTOMER_NAME": None,
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": None,
            "ORDER_REFERENCE": "4..2.",
            "PARENT_SEQUENCE": "4",
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "2",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2844562",
            "A_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "YUMAAZQU1ZW/999.9999.999.99/SWT",
            "ELEMENT_REFERENCE": "1754765",
            "ELEMENT_CATEGORY": "SWITCH",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "1 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "VLAN1110",
            "CHAN_INST_ID": "10977317",
            "SLOT": "01",
            "PORT_NAME": "1",
            "PORT_INST_ID": "114961569",
            "PORT_ACCESS_ID": "NETWORK-1-1-1-1",
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": None,
            "FQDN": "YUMAAZQU1ZW.CML.CHTRSE.COM",
            "MODEL": "FSP 150-GE114PRO-C",
            "VENDOR": "ADVA",
            "TID": "YUMAAZQU1ZW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "10.0.210.177/24",
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "2",
        },
    ]
    assert buy.get_dynamic_router_port_sequence_number(path_elements_parent) == "3"


@pytest.mark.unittest
def test_get_buy_nni_port_inst_id():
    buy_nni_path_elements = [
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "1.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "1",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA1CW/001.00D.004.01/RTR",
            "ELEMENT_REFERENCE": "503601",
            "ELEMENT_CATEGORY": "ROUTER",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "[0/2]/1",
            "PORT_NAME": "1",
            "PORT_INST_ID": "114433805",
            "PORT_ACCESS_ID": "XE-1/2/1",
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": "DYNAMIC",
            "FQDN": "PHNHAZVA1CW.CHTRSE.COM",
            "MODEL": "MX240",
            "VENDOR": "JUNIPER",
            "TID": "PHNHAZVA1CW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "24.43.180.244/32",
            "IPV6_ADDRESS": "2605:E000::F:8F/128",
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "60.KGFD.000001..TWCC",
            "INITIAL_CIRCUIT_ID": "2511364",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "2",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA/001.00D.004.42/MMP FDP",
            "ELEMENT_REFERENCE": "504691",
            "ELEMENT_CATEGORY": "FDP",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "OPTICAL",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "5",
            "PORT_NAME": "3",
            "PORT_INST_ID": "83466376",
            "PORT_ACCESS_ID": "27",
            "CONNECTOR_TYPE": "SC-UPC",
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": "ASBMMB1021480",
            "VENDOR": "ALL SYSTEMS BROADBAND",
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "60.KGFD.000001..TWCC",
            "INITIAL_CIRCUIT_ID": "2511364",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "3.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "3",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA/001.00D.004.42/MMP FDP",
            "ELEMENT_REFERENCE": "504691",
            "ELEMENT_CATEGORY": "FDP",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "OPTICAL",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "5",
            "PORT_NAME": "4",
            "PORT_INST_ID": "83466377",
            "PORT_ACCESS_ID": "28",
            "CONNECTOR_TYPE": "SC-UPC",
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": "ASBMMB1021480",
            "VENDOR": "ALL SYSTEMS BROADBAND",
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "60.KGFD.000001..TWCC",
            "INITIAL_CIRCUIT_ID": "2511364",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "4.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "4",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "ELEMENT_TYPE": "SEGMENT",
            "ELEMENT_NAME": "1F/KGFN/004238/LVLC",
            "ELEMENT_REFERENCE": "50976",
            "ELEMENT_CATEGORY": "CUSTOMER",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": None,
            "PORT_NAME": None,
            "PORT_INST_ID": None,
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": None,
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": None,
            "VENDOR": None,
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": None,
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "60.KGFD.000001..TWCC",
            "INITIAL_CIRCUIT_ID": "2511364",
            "LVL": "1",
        },
    ]
    assert buy.get_buy_nni_port_inst_id(buy_nni_path_elements) == "114433805"


@pytest.mark.unittest
def test_get_dynamic_router_port_location(monkeypatch: pytest.MonkeyPatch):
    parent_cid = "92.L1XX.004050..CHTR"
    path_elements_after_adding_buy_nni = [
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "3.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "3",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA1CW/001.00D.004.01/RTR",
            "ELEMENT_REFERENCE": "503601",
            "ELEMENT_CATEGORY": "ROUTER",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "100 Mbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "[0/2]/1",
            "PORT_NAME": "1-54",
            "PORT_INST_ID": "116249429",
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": "DYNAMIC",
            "FQDN": "PHNHAZVA1CW.CHTRSE.COM",
            "MODEL": "MX240",
            "VENDOR": "JUNIPER",
            "TID": "PHNHAZVA1CW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "24.43.180.244/32",
            "IPV6_ADDRESS": "2605:E000::F:8F/128",
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "5.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "5",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "YUMAAZQU1ZW/999.9999.999.99/SWT",
            "ELEMENT_REFERENCE": "1754765",
            "ELEMENT_CATEGORY": "SWITCH",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10/100/1000 BASET",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "CHASSIS PORTS",
            "PORT_NAME": "03",
            "PORT_INST_ID": "114961572",
            "PORT_ACCESS_ID": "ACCESS-1-1-1-3",
            "CONNECTOR_TYPE": "RJ-45",
            "PORT_CHANNELIZATION": None,
            "FQDN": "YUMAAZQU1ZW.CML.CHTRSE.COM",
            "MODEL": "FSP 150-GE114PRO-C",
            "VENDOR": "ADVA",
            "TID": "YUMAAZQU1ZW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "10.0.210.177/24",
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": "1110",
            "VLAN_OPERATION": "PUSH",
            "PORT_ROLE": "UNI-EP",
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
    ]
    monkeypatch.setattr(buy, "get_path_elements", lambda *args, **kwargs: path_elements_after_adding_buy_nni)
    assert buy.get_dynamic_router_port_location(parent_cid) == "5"


@pytest.mark.unittest
def test_resequence_dynamic_router_port(monkeypatch: pytest.MonkeyPatch):
    data = {
        "CIRC_PATH_INST_ID": "2330803",
        "CIRCUIT_NAME": "92.L1XX.004050..CHTR",
        "CIRCUIT_STATUS": "Live",
        "CIRCUIT_BANDWIDTH": "100 Mbps",
        "CIRCUIT_CATEGORY": "ETHERNET",
        "SERVICE_TYPE": "COM-DIA",
        "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
        "ORDER_NUM": "COM-FIA-097610,ENG-03367376",
        "ORDERED": "MAR 14, 2023",
        "IN_SERVICE": "MAR 25, 2023",
        "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
        "A_SITE_TYPE": "COLO",
        "A_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
        "A_SITE_REGION": "WEST",
        "A_ADDRESS": "615 N 48TH ST",
        "A_CITY": "PHOENIX",
        "A_STATE": "AZ",
        "A_ZIP": "85008",
        "A_FLOOR": "1",
        "A_ROOM": "D",
        "A_CLLI": "PHNHAZVA",
        "A_NPA": "602",
        "A_LONGITUDE": "-111.977644",
        "A_LATITUDE": "33.455597",
        "Z_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
        "Z_SITE_TYPE": "CUST_OFFNET",
        "Z_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
        "Z_SITE_REGION": "WEST",
        "Z_ADDRESS": "3382 E GILA RIDGE RD",
        "Z_CITY": "YUMA",
        "Z_STATE": "AZ",
        "Z_ZIP": "85365",
        "Z_COMMENTS": "ENG-04168855\nCPE Fiber Installer\t\nJose E Morales\nAs Built Demarcation Location\t\n \nManaged Services Installer Type\t\n \nCPE Install Notes\t\n10/19-JM- Install complete. Cradleopint configured.\n\nCradlepoint location: 1st floor IT room, Wall mounted on backboard.",
        "Z_CLLI": "YUMAAZQU",
        "Z_NPA": "928",
        "Z_LONGITUDE": "-114.575279",
        "Z_LATITUDE": "32.686742",
        "LEG_NAME": "1",
        "LEG_INST_ID": "2665424",
    }
    parent_cid = "92.L1XX.004050..CHTR"
    path_elements_parent = [
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "1.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "1",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": None,
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "CLOUD",
            "ELEMENT_NAME": "CHTRSE.CEN.WEST.MPLS",
            "ELEMENT_REFERENCE": "1129",
            "ELEMENT_CATEGORY": "MPLS",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": None,
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": None,
            "PORT_NAME": None,
            "PORT_INST_ID": None,
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": None,
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": None,
            "VENDOR": None,
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": None,
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "2",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "ELEMENT_TYPE": "PATH",
            "ELEMENT_NAME": "60.KGFD.000001..TWCC",
            "ELEMENT_REFERENCE": "2511364",
            "ELEMENT_CATEGORY": "ETHERNET TRANSPORT",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": "2190296",
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977382",
            "SLOT": None,
            "PORT_NAME": None,
            "PORT_INST_ID": None,
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": None,
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": None,
            "VENDOR": None,
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": None,
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "3.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "3",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA1CW/001.00D.004.01/RTR",
            "ELEMENT_REFERENCE": "503601",
            "ELEMENT_CATEGORY": "ROUTER",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "100 Mbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "[0/2]/1",
            "PORT_NAME": "1-54",
            "PORT_INST_ID": "116249429",
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": "DYNAMIC",
            "FQDN": "PHNHAZVA1CW.CHTRSE.COM",
            "MODEL": "MX240",
            "VENDOR": "JUNIPER",
            "TID": "PHNHAZVA1CW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "24.43.180.244/32",
            "IPV6_ADDRESS": "2605:E000::F:8F/128",
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "4.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "4",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "ELEMENT_TYPE": "PATH",
            "ELEMENT_NAME": "92001.GE1.PHNHAZVA1CW.YUMAAZQU1ZW",
            "ELEMENT_REFERENCE": "2468478",
            "ELEMENT_CATEGORY": "ETHERNET TRANSPORT",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "1 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "VLAN1110",
            "CHAN_INST_ID": "10977317",
            "SLOT": None,
            "PORT_NAME": None,
            "PORT_INST_ID": None,
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": None,
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": None,
            "VENDOR": None,
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": None,
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "5.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "5",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "YUMAAZQU1ZW/999.9999.999.99/SWT",
            "ELEMENT_REFERENCE": "1754765",
            "ELEMENT_CATEGORY": "SWITCH",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10/100/1000 BASET",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "CHASSIS PORTS",
            "PORT_NAME": "03",
            "PORT_INST_ID": "114961572",
            "PORT_ACCESS_ID": "ACCESS-1-1-1-3",
            "CONNECTOR_TYPE": "RJ-45",
            "PORT_CHANNELIZATION": None,
            "FQDN": "YUMAAZQU1ZW.CML.CHTRSE.COM",
            "MODEL": "FSP 150-GE114PRO-C",
            "VENDOR": "ADVA",
            "TID": "YUMAAZQU1ZW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "10.0.210.177/24",
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": "1110",
            "VLAN_OPERATION": "PUSH",
            "PORT_ROLE": "UNI-EP",
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2..1.",
            "PARENT_SEQUENCE": "2",
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "1",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA1CW/001.00D.004.01/RTR",
            "ELEMENT_REFERENCE": "503601",
            "ELEMENT_CATEGORY": "ROUTER",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977382",
            "SLOT": "[0/2]/1",
            "PORT_NAME": "1",
            "PORT_INST_ID": "114433805",
            "PORT_ACCESS_ID": "XE-1/2/1",
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": "DYNAMIC",
            "FQDN": "PHNHAZVA1CW.CHTRSE.COM",
            "MODEL": "MX240",
            "VENDOR": "JUNIPER",
            "TID": "PHNHAZVA1CW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "24.43.180.244/32",
            "IPV6_ADDRESS": "2605:E000::F:8F/128",
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "2",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2..2.",
            "PARENT_SEQUENCE": "2",
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "2",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA/001.00D.004.42/MMP FDP",
            "ELEMENT_REFERENCE": "504691",
            "ELEMENT_CATEGORY": "FDP",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "OPTICAL",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977382",
            "SLOT": "5",
            "PORT_NAME": "3",
            "PORT_INST_ID": "83466376",
            "PORT_ACCESS_ID": "27",
            "CONNECTOR_TYPE": "SC-UPC",
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": "ASBMMB1021480",
            "VENDOR": "ALL SYSTEMS BROADBAND",
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "2",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2..3.",
            "PARENT_SEQUENCE": "2",
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "3",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA/001.00D.004.42/MMP FDP",
            "ELEMENT_REFERENCE": "504691",
            "ELEMENT_CATEGORY": "FDP",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "OPTICAL",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977382",
            "SLOT": "5",
            "PORT_NAME": "4",
            "PORT_INST_ID": "83466377",
            "PORT_ACCESS_ID": "28",
            "CONNECTOR_TYPE": "SC-UPC",
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": "ASBMMB1021480",
            "VENDOR": "ALL SYSTEMS BROADBAND",
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "2",
        },
        {
            "CIRC_PATH_INST_ID": "2468478",
            "PATH_NAME": "92001.GE1.PHNHAZVA1CW.YUMAAZQU1ZW",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": None,
            "EVC_ID": None,
            "SERVICE_TYPE": "INT-ACCESS TO PREM TRANSPORT",
            "BANDWIDTH": "1 Gbps",
            "BW_SIZE": "1000000000",
            "CUSTOMER_ID": None,
            "CUSTOMER_NAME": None,
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": None,
            "ORDER_REFERENCE": "4..2.",
            "PARENT_SEQUENCE": "4",
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "2",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2844562",
            "A_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "YUMAAZQU1ZW/999.9999.999.99/SWT",
            "ELEMENT_REFERENCE": "1754765",
            "ELEMENT_CATEGORY": "SWITCH",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "1 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "VLAN1110",
            "CHAN_INST_ID": "10977317",
            "SLOT": "01",
            "PORT_NAME": "1",
            "PORT_INST_ID": "114961569",
            "PORT_ACCESS_ID": "NETWORK-1-1-1-1",
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": None,
            "FQDN": "YUMAAZQU1ZW.CML.CHTRSE.COM",
            "MODEL": "FSP 150-GE114PRO-C",
            "VENDOR": "ADVA",
            "TID": "YUMAAZQU1ZW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "10.0.210.177/24",
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "2",
        },
    ]
    resequence_dynamic_router_port_resp = {
        "pathId": "92.L1XX.004050..CHTR",
        "pathRev": "1",
        "status": "Live",
        "pathInstanceId": "2330803",
        "retString": "Path Updated",
    }
    monkeypatch.setattr(buy, "get_dynamic_router_port_location", lambda *args, **kwargs: "5")
    monkeypatch.setattr(buy, "get_dynamic_router_port_sequence_number", lambda *args, **kwargs: "3")
    monkeypatch.setattr(buy, "put_granite", lambda *args, **kwargs: resequence_dynamic_router_port_resp)
    assert (
        buy._resequence_dynamic_router_port(data, parent_cid, path_elements_parent)
        == resequence_dynamic_router_port_resp
    )

    monkeypatch.setattr(buy, "get_dynamic_router_port_location", lambda *args, **kwargs: "")
    try:
        buy._resequence_dynamic_router_port(data, parent_cid, path_elements_parent)
    except AbortException as e:
        assert e.code == 500


@pytest.mark.unittest
def test_oversubscribe_check(monkeypatch):
    # bad test NNI oversubscribed
    monkeypatch.setattr(buy, "get_granite", lambda *args, **kwargs: [{"UTILIZATION": "101"}])
    monkeypatch.setattr(buy, "get_attributes_for_path", lambda *args, **kwargs: [{"bandwidth": "100 Mbps"}])

    with raises(Exception):
        assert buy.oversubscribe_check("NNI_name", "nni_inst-id", "test_cid") is None

    # bad test cid BW will oversubcribe NNI
    monkeypatch.setattr(buy, "get_granite", lambda *args, **kwargs: [{"UTILIZATION": "86", "AVAILABLE_BW": "30000000"}])
    monkeypatch.setattr(buy, "get_attributes_for_path", lambda *args, **kwargs: [{"bandwidth": "100 Mbps"}])

    with raises(AbortException):
        assert buy.oversubscribe_check("NNI_name", "nni_inst-id", "test_cid") is None

    # good test
    monkeypatch.setattr(
        buy, "get_granite", lambda *args, **kwargs: [{"UTILIZATION": "86", "AVAILABLE_BW": "3000000000"}]
    )
    assert buy.oversubscribe_check("NNI_name", "nni_inst-id", "test_cid") is None


@pytest.mark.unittest
def test_create_transport_path(monkeypatch: pytest.MonkeyPatch):
    test_type_two_payload = {
        "cid": "92.L1XX.004050..CHTR",
        "third_party_provided_circuit": "Y",
        "service_provider": "COMCAST / Comcast",
        "service_provider_uni_cid": "70.KGGS.021142..CPBL..",
        "service_provider_cid": "70.VLXP.019925.ON.CPBL..",
        "service_provider_vlan": "3991",
        "spectrum_buy_nni_circuit_id": "60.KGFD.000001..TWCC",
    }
    # mock data
    z_side_details = {"Z_CLLI": "YUMAAZQU", "Z_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD"}
    a_side_details = {
        "A_CLLI": "PHNHAZVA",
        "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
    }
    a_side_router = "PHNHAZVA1CW"
    transport_paths = []
    transport_path_name = "92001.GE1.PHNHAZVA1CW.YUMAAZQU4ZW"
    bandwidth_string = "1 Gbps"
    create_transport_path_at_granite = {
        "pathId": "92001.GE1.PHNHAZVA1CW.YUMAAZQU4ZW",
        "pathRev": "1",
        "status": "Auto-Planned",
        "pathInstanceId": "2638669",
        "retString": "Path Added",
    }
    transport_path_data = {
        "path_inst_id": "2638669",
        "leg_name": "1",
        "leg_inst_id": "3069793",
        "z_site_name": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
    }
    segment_inst_id = iter(["", "73558"])
    reserve_segment_on_granite = {
        "pathId": "92001.GE1.PHNHAZVA1CW.YUMAAZQU4ZW",
        "pathRev": "1",
        "status": "Auto-Planned",
        "pathInstanceId": "2638669",
        "retString": "Path Updated",
    }
    new_sequence_number = "4"
    add_transport_channel_to_ethernet_path = {
        "pathId": "92001.GE1.PHNHAZVA1CW.YUMAAZQU4ZW",
        "pathRev": "1",
        "status": "Auto-Planned",
        "pathInstanceId": "2638669",
        "retString": "Path Updated",
    }
    resp = {"cpe_transport_path": "92001.GE1.PHNHAZVA1CW.YUMAAZQU4ZW"}

    monkeypatch.setattr(tp, "get_z_side_details_from_service_path_cid", lambda *args, **kwargs: z_side_details)
    monkeypatch.setattr(tp, "get_a_side_details_from_buy_nni_cid", lambda *args, **kwargs: a_side_details)
    monkeypatch.setattr(tp, "find_nni_device", lambda *args, **kwargs: a_side_router)
    monkeypatch.setattr(
        tp, "get_list_of_cpe_transport_paths_with_a_side_router", lambda *args, **kwargs: transport_paths
    )
    monkeypatch.setattr(tp, "build_transport_path", lambda *args, **kwargs: (transport_path_name, bandwidth_string))
    monkeypatch.setattr(
        tp, "_create_transport_path_at_granite", lambda *args, **kwargs: create_transport_path_at_granite
    )
    monkeypatch.setattr(tp, "get_transport_path_data", lambda *args, **kwargs: transport_path_data)
    monkeypatch.setattr(tp, "get_existing_segment_inst_id", lambda *args, **kwargs: next(segment_inst_id))
    monkeypatch.setattr(tp, "get_new_segment_inst_id", lambda *args, **kwargs: next(segment_inst_id))
    monkeypatch.setattr(tp, "_reserve_segment_on_granite", lambda *args, **kwargs: reserve_segment_on_granite)
    monkeypatch.setattr(tp, "sequence_number_for_new_service_path_element", lambda *args, **kwargs: new_sequence_number)
    monkeypatch.setattr(
        tp, "_add_transport_channel_to_ethernet_path", lambda *args, **kwargs: add_transport_channel_to_ethernet_path
    )

    assert tp.create_transport_path(test_type_two_payload) == resp


@pytest.mark.unittest
def test_create_transport_path_increment(monkeypatch: pytest.MonkeyPatch):
    test_type_two_payload = {
        "cid": "92.L1XX.004050..CHTR",
        "third_party_provided_circuit": "Y",
        "service_provider": "COMCAST / Comcast",
        "service_provider_uni_cid": "70.KGGS.021142..CPBL..",
        "service_provider_cid": "70.VLXP.019925.ON.CPBL..",
        "service_provider_vlan": "3991",
        "spectrum_buy_nni_circuit_id": "60.KGFD.000001..TWCC",
    }
    # mock data
    z_side_details = {"Z_CLLI": "YUMAAZQU", "Z_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD"}
    a_side_details = {
        "A_CLLI": "PHNHAZVA",
        "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
    }
    a_side_router = "PHNHAZVA1CW"
    transport_paths = ["92001.GE1.PHNHAZVA1CW.YUMAAZQU4ZW"]
    create_transport_path_at_granite = {
        "pathId": "92002.GE1.PHNHAZVA1CW.YUMAAZQU4ZW",
        "pathRev": "1",
        "status": "Auto-Planned",
        "pathInstanceId": "2638669",
        "retString": "Path Added",
    }
    transport_path_data = {
        "path_inst_id": "2638669",
        "leg_name": "1",
        "leg_inst_id": "3069793",
        "z_site_name": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
    }
    segment_inst_id = iter(["", "73558"])
    reserve_segment_on_granite = {
        "pathId": "92002.GE1.PHNHAZVA1CW.YUMAAZQU4ZW",
        "pathRev": "1",
        "status": "Auto-Planned",
        "pathInstanceId": "2638669",
        "retString": "Path Updated",
    }
    new_sequence_number = "4"
    add_transport_channel_to_ethernet_path = {
        "pathId": "92002.GE1.PHNHAZVA1CW.YUMAAZQU4ZW",
        "pathRev": "1",
        "status": "Auto-Planned",
        "pathInstanceId": "2638669",
        "retString": "Path Updated",
    }
    resp = {"cpe_transport_path": "92002.GE1.PHNHAZVA1CW.YUMAAZQU4ZW"}

    monkeypatch.setattr(tp, "get_z_side_details_from_service_path_cid", lambda *args, **kwargs: z_side_details)
    monkeypatch.setattr(tp, "get_a_side_details_from_buy_nni_cid", lambda *args, **kwargs: a_side_details)
    monkeypatch.setattr(tp, "find_nni_device", lambda *args, **kwargs: a_side_router)
    monkeypatch.setattr(
        tp, "get_list_of_cpe_transport_paths_with_a_side_router", lambda *args, **kwargs: transport_paths
    )
    monkeypatch.setattr(
        tp, "_create_transport_path_at_granite", lambda *args, **kwargs: create_transport_path_at_granite
    )
    monkeypatch.setattr(tp, "get_transport_path_data", lambda *args, **kwargs: transport_path_data)
    monkeypatch.setattr(tp, "get_existing_segment_inst_id", lambda *args, **kwargs: next(segment_inst_id))
    monkeypatch.setattr(tp, "get_new_segment_inst_id", lambda *args, **kwargs: next(segment_inst_id))
    monkeypatch.setattr(tp, "_reserve_segment_on_granite", lambda *args, **kwargs: reserve_segment_on_granite)
    monkeypatch.setattr(tp, "sequence_number_for_new_service_path_element", lambda *args, **kwargs: new_sequence_number)
    monkeypatch.setattr(
        tp, "_add_transport_channel_to_ethernet_path", lambda *args, **kwargs: add_transport_channel_to_ethernet_path
    )

    assert tp.create_transport_path(test_type_two_payload) == resp


@pytest.mark.unittest
def test_create_transport_path_AbortException(monkeypatch: pytest.MonkeyPatch):
    test_type_two_payload = {
        "cid": "92.L1XX.004050..CHTR",
        "third_party_provided_circuit": "Y",
        "service_provider": "COMCAST / Comcast",
        "service_provider_uni_cid": "70.KGGS.021142..CPBL..",
        "service_provider_cid": "70.VLXP.019925.ON.CPBL..",
        "service_provider_vlan": "3991",
        "spectrum_buy_nni_circuit_id": "60.KGFD.000001..TWCC",
    }
    # mock data
    z_side_details = {"Z_CLLI": "YUMAAZQU", "Z_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD"}
    a_side_details = {
        "A_CLLI": "PHNHAZVA",
        "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
    }
    a_side_router = "PHNHAZVA1CW"
    transport_paths = ["92001.GE1.PHNHAZVA1CW.YUMAAZQU4ZW", "92002.GE1.PHNHAZVA1CW.YUMAAZQU4ZW"]

    monkeypatch.setattr(tp, "get_z_side_details_from_service_path_cid", lambda *args, **kwargs: z_side_details)
    monkeypatch.setattr(tp, "get_a_side_details_from_buy_nni_cid", lambda *args, **kwargs: a_side_details)
    monkeypatch.setattr(tp, "find_nni_device", lambda *args, **kwargs: a_side_router)
    monkeypatch.setattr(
        tp, "get_list_of_cpe_transport_paths_with_a_side_router", lambda *args, **kwargs: transport_paths
    )

    # multiple transport paths found for CPE device
    try:
        tp.create_transport_path(test_type_two_payload)
    except AbortException as e:
        assert e.code == 500
        assert f"Multiple transport paths found for CPE device: {transport_paths[0].split('.')[-1]}" in e.data["message"]


@pytest.mark.unittest
def test_get_z_side_details_from_service_path_cid(monkeypatch: pytest.MonkeyPatch):
    service_path_cid = "92.L1XX.004050..CHTR"
    data = [
        {
            "CIRC_PATH_INST_ID": "2330803",
            "CIRCUIT_NAME": "92.L1XX.004050..CHTR",
            "CIRCUIT_STATUS": "Auto-Planned",
            "CIRCUIT_BANDWIDTH": "100 Mbps",
            "CIRCUIT_CATEGORY": "ETHERNET",
            "SERVICE_TYPE": "COM-DIA",
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "ORDER_NUM": "COM-FIA-097610,ENG-03367376",
            "ORDERED": "MAR 14, 2023",
            "IN_SERVICE": "MAR 25, 2023",
            "A_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_SITE_TYPE": "CUST_OFFNET",
            "A_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
            "A_SITE_REGION": "WEST",
            "A_ADDRESS": "3382 E GILA RIDGE RD",
            "A_CITY": "YUMA",
            "A_STATE": "AZ",
            "A_ZIP": "85365",
            "A_COMMENTS": "ENG-04168855\nCPE Fiber Installer\t\nJose E Morales\nAs Built Demarcation Location\t\n \nManaged Services Installer Type\t\n \nCPE Install Notes\t\n10/19-JM- Install complete. Cradleopint configured.\n\nCradlepoint location: 1st floor IT room, Wall mounted on backboard.",
            "A_CLLI": "YUMAAZQU",
            "A_NPA": "928",
            "A_LONGITUDE": "-114.575279",
            "A_LATITUDE": "32.686742",
            "Z_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "Z_SITE_TYPE": "CUST_OFFNET",
            "Z_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
            "Z_SITE_REGION": "WEST",
            "Z_ADDRESS": "3382 E GILA RIDGE RD",
            "Z_CITY": "YUMA",
            "Z_STATE": "AZ",
            "Z_ZIP": "85365",
            "Z_COMMENTS": "ENG-04168855\nCPE Fiber Installer\t\nJose E Morales\nAs Built Demarcation Location\t\n \nManaged Services Installer Type\t\n \nCPE Install Notes\t\n10/19-JM- Install complete. Cradleopint configured.\n\nCradlepoint location: 1st floor IT room, Wall mounted on backboard.",
            "Z_CLLI": "YUMAAZQU",
            "Z_NPA": "928",
            "Z_LONGITUDE": "-114.575279",
            "Z_LATITUDE": "32.686742",
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
        }
    ]
    z_side_details = {"Z_CLLI": "YUMAAZQU", "Z_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD"}

    monkeypatch.setattr(tp, "get_granite", lambda *args, **kwargs: data)

    assert tp.get_z_side_details_from_service_path_cid(service_path_cid) == z_side_details


@pytest.mark.unittest
def test_get_z_side_details_from_service_path_cid_AbortExceptions(monkeypatch: pytest.MonkeyPatch):
    service_path_cid = "92.L1XX.004050..CHTR"
    data = [
        {
            "CIRC_PATH_INST_ID": "2330803",
            "CIRCUIT_NAME": "92.L1XX.004050..CHTR",
            "CIRCUIT_STATUS": "Auto-Planned",
            "CIRCUIT_BANDWIDTH": "100 Mbps",
            "CIRCUIT_CATEGORY": "ETHERNET",
            "SERVICE_TYPE": "COM-DIA",
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "ORDER_NUM": "COM-FIA-097610,ENG-03367376",
            "ORDERED": "MAR 14, 2023",
            "IN_SERVICE": "MAR 25, 2023",
            "A_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_SITE_TYPE": "CUST_OFFNET",
            "A_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
            "A_SITE_REGION": "WEST",
            "A_ADDRESS": "3382 E GILA RIDGE RD",
            "A_CITY": "YUMA",
            "A_STATE": "AZ",
            "A_ZIP": "85365",
            "A_COMMENTS": "ENG-04168855\nCPE Fiber Installer\t\nJose E Morales\nAs Built Demarcation Location\t\n \nManaged Services Installer Type\t\n \nCPE Install Notes\t\n10/19-JM- Install complete. Cradleopint configured.\n\nCradlepoint location: 1st floor IT room, Wall mounted on backboard.",
            "A_CLLI": "YUMAAZQU",
            "A_NPA": "928",
            "A_LONGITUDE": "-114.575279",
            "A_LATITUDE": "32.686742",
            "Z_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "Z_SITE_TYPE": "CUST_OFFNET",
            "Z_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
            "Z_SITE_REGION": "WEST",
            "Z_ADDRESS": "3382 E GILA RIDGE RD",
            "Z_CITY": "YUMA",
            "Z_STATE": "AZ",
            "Z_ZIP": "85365",
            "Z_COMMENTS": "ENG-04168855\nCPE Fiber Installer\t\nJose E Morales\nAs Built Demarcation Location\t\n \nManaged Services Installer Type\t\n \nCPE Install Notes\t\n10/19-JM- Install complete. Cradleopint configured.\n\nCradlepoint location: 1st floor IT room, Wall mounted on backboard.",
            "Z_CLLI": "YUMAAZQU",
            "Z_NPA": "928",
            "Z_LONGITUDE": "-114.575279",
            "Z_LATITUDE": "32.686742",
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
        }
    ]

    monkeypatch.setattr(tp, "get_granite", lambda *args, **kwargs: d1)

    # undefined Z-side site details
    d1 = deepcopy(data)
    d1[0]["Z_SITE_NAME"] = ""
    try:
        tp.get_z_side_details_from_service_path_cid(service_path_cid)
    except AbortException as e:
        assert e.code == 500
        assert f"Z-side site information is missing for {service_path_cid}" in e.data["message"]

    # unable to obtain Z-side site details
    d1 = deepcopy(data)
    d1[0].pop("Z_SITE_NAME")
    try:
        tp.get_z_side_details_from_service_path_cid(service_path_cid)
    except AbortException as e:
        assert e.code == 500
        assert f"Unable to obtain Z-side site details for {service_path_cid}" in e.data["message"]

    # unable to pull circuit sites data
    d1 = deepcopy(data)
    d1 = d1[0]
    try:
        tp.get_z_side_details_from_service_path_cid(service_path_cid)
    except AbortException as e:
        assert e.code == 500
        assert f"Unable to pull circuit sites data for {service_path_cid}" in e.data["message"]


@pytest.mark.unittest
def test_get_a_side_details_from_buy_nni_cid(monkeypatch: pytest.MonkeyPatch):
    buy_nni_cid = "60.KGFD.000001..TWCC"
    data = [
        {
            "CIRC_PATH_INST_ID": "2511364",
            "CIRCUIT_NAME": "60.KGFD.000001..TWCC",
            "CIRCUIT_STATUS": "Live",
            "CIRCUIT_BANDWIDTH": "10 Gbps",
            "CIRCUIT_CATEGORY": "ETHERNET TRANSPORT",
            "PREV_PATH_INST_ID": "2190296",
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "ORDER_NUM": "ENG-01250944",
            "ORDERED": "MAY 19, 2023",
            "IN_SERVICE": "MAY 22, 2023",
            "SCHEDULED": "MAY 22, 2023",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_SITE_TYPE": "COLO",
            "A_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
            "A_SITE_REGION": "WEST",
            "A_ADDRESS": "615 N 48TH ST",
            "A_CITY": "PHOENIX",
            "A_STATE": "AZ",
            "A_ZIP": "85008",
            "A_FLOOR": "1",
            "A_ROOM": "D",
            "A_CLLI": "PHNHAZVA",
            "A_NPA": "602",
            "A_LONGITUDE": "-111.977644",
            "A_LATITUDE": "33.455597",
            "Z_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_TYPE": "COLO",
            "Z_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
            "Z_SITE_REGION": "WEST",
            "Z_ADDRESS": "615 N 48TH ST",
            "Z_CITY": "PHOENIX",
            "Z_STATE": "AZ",
            "Z_ZIP": "85008",
            "Z_FLOOR": "1",
            "Z_ROOM": "D",
            "Z_CLLI": "PHNHAZVA",
            "Z_NPA": "602",
            "Z_LONGITUDE": "-111.977644",
            "Z_LATITUDE": "33.455597",
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
        }
    ]
    a_side_details = {
        "A_CLLI": "PHNHAZVA",
        "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
    }

    monkeypatch.setattr(tp, "get_granite", lambda *args, **kwargs: data)

    assert tp.get_a_side_details_from_buy_nni_cid(buy_nni_cid) == a_side_details


@pytest.mark.unittest
def test_get_a_side_details_from_buy_nni_cid_AbortExceptions(monkeypatch: pytest.MonkeyPatch):
    buy_nni_cid = "60.KGFD.000001..TWCC"
    data = [
        {
            "CIRC_PATH_INST_ID": "2511364",
            "CIRCUIT_NAME": "60.KGFD.000001..TWCC",
            "CIRCUIT_STATUS": "Live",
            "CIRCUIT_BANDWIDTH": "10 Gbps",
            "CIRCUIT_CATEGORY": "ETHERNET TRANSPORT",
            "PREV_PATH_INST_ID": "2190296",
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "ORDER_NUM": "ENG-01250944",
            "ORDERED": "MAY 19, 2023",
            "IN_SERVICE": "MAY 22, 2023",
            "SCHEDULED": "MAY 22, 2023",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_SITE_TYPE": "COLO",
            "A_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
            "A_SITE_REGION": "WEST",
            "A_ADDRESS": "615 N 48TH ST",
            "A_CITY": "PHOENIX",
            "A_STATE": "AZ",
            "A_ZIP": "85008",
            "A_FLOOR": "1",
            "A_ROOM": "D",
            "A_CLLI": "PHNHAZVA",
            "A_NPA": "602",
            "A_LONGITUDE": "-111.977644",
            "A_LATITUDE": "33.455597",
            "Z_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_TYPE": "COLO",
            "Z_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
            "Z_SITE_REGION": "WEST",
            "Z_ADDRESS": "615 N 48TH ST",
            "Z_CITY": "PHOENIX",
            "Z_STATE": "AZ",
            "Z_ZIP": "85008",
            "Z_FLOOR": "1",
            "Z_ROOM": "D",
            "Z_CLLI": "PHNHAZVA",
            "Z_NPA": "602",
            "Z_LONGITUDE": "-111.977644",
            "Z_LATITUDE": "33.455597",
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
        }
    ]

    monkeypatch.setattr(tp, "get_granite", lambda *args, **kwargs: d1)

    # undefined A-side site details
    d1 = deepcopy(data)
    d1[0]["A_CLLI"] = ""
    try:
        tp.get_a_side_details_from_buy_nni_cid(buy_nni_cid)
    except AbortException as e:
        assert e.code == 500
        assert f"A-side site information is missing for {buy_nni_cid}" in e.data["message"]

    # unable to obtain A-side site details
    d1 = deepcopy(data)
    d1[0].pop("A_SITE_NAME")
    try:
        tp.get_a_side_details_from_buy_nni_cid(buy_nni_cid)
    except AbortException as e:
        assert e.code == 500
        assert f"Unable to obtain A-side site details for {buy_nni_cid}" in e.data["message"]

    # unable to pull circuit sites data
    d1 = deepcopy(data)
    d1 = d1[0]
    try:
        tp.get_a_side_details_from_buy_nni_cid(buy_nni_cid)
    except AbortException as e:
        assert e.code == 500
        assert f"Unable to pull circuit sites data for {buy_nni_cid}" in e.data["message"]


@pytest.mark.unittest
def test_get_list_of_cpe_transport_paths_with_a_side_router(monkeypatch: pytest.MonkeyPatch):
    # mock data
    a_side_router = "PHNHAZVA1CW"
    z_site_name = "PHNRAZYK-BELMARK INC//875 S 65TH AVE"
    paths = [
        {
            "aSideSiteName": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "bandwidth": "1 Gbps",
            "category": "ETHERNET TRANSPORT",
            "gia_UDA": "NO",
            "off_NetFacility_UDA": "YES",
            "pathId": "62001.GE1.PHNHAZVA1CW.PHNRAZYK2ZW",
            "pathInService": "2022-02-18 12:00:00.0",
            "pathRev": "1",
            "product_Service_UDA": "INT-ACCESS TO PREM TRANSPORT",
            "servicePriority": "NO",
            "status": "Live",
            "topology": "P",
            "tspChildPresent_UDA": "NO",
            "zSideSiteName": "PHNRAZYK-BELMARK INC//875 S 65TH AVE",
            "instanceProtocol": "9999",
            "pathInstanceId": "2246719",
            "serviceMedia": "FIBER",
            "startChanNbr": "1",
            "virtualChans": "D",
        },
        {
            "aSideSiteName": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "bandwidth": "1 Gbps",
            "category": "ETHERNET TRANSPORT",
            "gia_UDA": "NO",
            "off_NetFacility_UDA": "YES",
            "pathId": "92001.GE1.PHNHAZVA1CW.SEDNAZ121ZW",
            "pathInService": "2021-03-12 12:00:00.0",
            "pathRev": "1",
            "product_Service_UDA": "INT-ACCESS TO PREM TRANSPORT",
            "servicePriority": "NO",
            "status": "Live",
            "topology": "P",
            "tspChildPresent_UDA": "NO",
            "zSideSiteName": "SEDNAZ12-BUILDERS FIRSTSOURCE, INC//2385 W STATE ROUTE 89A",
            "instanceProtocol": "9999",
            "pathInstanceId": "2031258",
            "serviceMedia": "FIBER",
            "startChanNbr": "1",
            "virtualChans": "D",
        },
        {
            "aSideSiteName": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "bandwidth": "1 Gbps",
            "category": "ETHERNET TRANSPORT",
            "gia_UDA": "NO",
            "off_NetFacility_UDA": "YES",
            "pathId": "62001.GE1.PHNHAZVA1CW.PHNRAZYK1ZW",
            "pathRev": "1",
            "product_Service_UDA": "INT-ACCESS TO PREM TRANSPORT",
            "servicePriority": "NO",
            "status": "Designed",
            "topology": "P",
            "tspChildPresent_UDA": "NO",
            "zSideSiteName": "PHNRAZYK-BELMARK INC//875 S 65TH AVE",
            "instanceProtocol": "9999",
            "pathInstanceId": "2075482",
            "serviceMedia": "FIBER",
            "startChanNbr": "1",
            "virtualChans": "D",
        },
    ]
    transport_paths = ["62001.GE1.PHNHAZVA1CW.PHNRAZYK2ZW", "62001.GE1.PHNHAZVA1CW.PHNRAZYK1ZW"]

    monkeypatch.setattr(tp, "get_granite", lambda *args, **kwargs: paths)

    assert tp.get_list_of_cpe_transport_paths_with_a_side_router(a_side_router, z_site_name) == transport_paths


@pytest.mark.unittest
def test_get_list_of_cpe_transport_paths_with_a_side_router_AbortException(monkeypatch: pytest.MonkeyPatch):
    # mock data
    a_side_router = "PHNHAZVA1CW"
    z_site_name = "PHNRAZYK-BELMARK INC//875 S 65TH AVE"
    paths = [
        {
            "aSideSiteName": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "bandwidth": "1 Gbps",
            "category": "ETHERNET TRANSPORT",
            "gia_UDA": "NO",
            "off_NetFacility_UDA": "YES",
            "pathId": "62001.GE1.PHNHAZVA1CW.PHNRAZYK2ZW",
            "pathInService": "2022-02-18 12:00:00.0",
            "pathRev": "1",
            "product_Service_UDA": "INT-ACCESS TO PREM TRANSPORT",
            "servicePriority": "NO",
            "status": "Live",
            "topology": "P",
            "tspChildPresent_UDA": "NO",
            "zSideSiteName": "PHNRAZYK-BELMARK INC//875 S 65TH AVE",
            "instanceProtocol": "9999",
            "pathInstanceId": "2246719",
            "serviceMedia": "FIBER",
            "startChanNbr": "1",
            "virtualChans": "D",
        },
        {
            "aSideSiteName": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "bandwidth": "1 Gbps",
            "category": "ETHERNET TRANSPORT",
            "gia_UDA": "NO",
            "off_NetFacility_UDA": "YES",
            "pathId": "92001.GE1.PHNHAZVA1CW.SEDNAZ121ZW",
            "pathInService": "2021-03-12 12:00:00.0",
            "pathRev": "1",
            "product_Service_UDA": "INT-ACCESS TO PREM TRANSPORT",
            "servicePriority": "NO",
            "status": "Live",
            "topology": "P",
            "tspChildPresent_UDA": "NO",
            "zSideSiteName": "SEDNAZ12-BUILDERS FIRSTSOURCE, INC//2385 W STATE ROUTE 89A",
            "instanceProtocol": "9999",
            "pathInstanceId": "2031258",
            "serviceMedia": "FIBER",
            "startChanNbr": "1",
            "virtualChans": "D",
        },
        {
            "aSideSiteName": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "bandwidth": "1 Gbps",
            "category": "ETHERNET TRANSPORT",
            "gia_UDA": "NO",
            "off_NetFacility_UDA": "YES",
            "pathId": "62001.GE1.PHNHAZVA1CW.PHNRAZYK1ZW",
            "pathRev": "1",
            "product_Service_UDA": "INT-ACCESS TO PREM TRANSPORT",
            "servicePriority": "NO",
            "status": "Designed",
            "topology": "P",
            "tspChildPresent_UDA": "NO",
            "zSideSiteName": "PHNRAZYK-BELMARK INC//875 S 65TH AVE",
            "instanceProtocol": "9999",
            "pathInstanceId": "2075482",
            "serviceMedia": "FIBER",
            "startChanNbr": "1",
            "virtualChans": "D",
        },
    ]

    monkeypatch.setattr(tp, "get_granite", lambda *args, **kwargs: p1)

    # unable to pull transport path data
    p1 = deepcopy(paths)
    p1 = p1[0]
    try:
        tp.get_list_of_cpe_transport_paths_with_a_side_router(a_side_router, z_site_name)
    except AbortException as e:
        assert e.code == 500
        assert "Unable to pull transport path data" in e.data["message"]


@pytest.mark.unittest
def test_build_transport_path(monkeypatch: pytest.MonkeyPatch):
    cid = "92.L1XX.004050..CHTR"
    path_elements = [
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "YUMAAZQU",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "CUST_OFFNET",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Auto-Planned",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "1.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "1",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "ELEMENT_TYPE": "PATH",
            "ELEMENT_NAME": "60.KGFD.000001..TWCC",
            "ELEMENT_REFERENCE": "2511364",
            "ELEMENT_CATEGORY": "ETHERNET TRANSPORT",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": "2190296",
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977796",
            "SLOT": None,
            "PORT_NAME": None,
            "PORT_INST_ID": None,
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": None,
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": None,
            "VENDOR": None,
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": None,
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "YUMAAZQU",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "CUST_OFFNET",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Auto-Planned",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "2",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA1CW/001.00D.004.01/RTR",
            "ELEMENT_REFERENCE": "503601",
            "ELEMENT_CATEGORY": "ROUTER",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "100 Mbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "[0/2]/1",
            "PORT_NAME": "1-54",
            "PORT_INST_ID": "116252076",
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": "DYNAMIC",
            "FQDN": "PHNHAZVA1CW.CHTRSE.COM",
            "MODEL": "MX240",
            "VENDOR": "JUNIPER",
            "TID": "PHNHAZVA1CW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "24.43.180.244/32",
            "IPV6_ADDRESS": "2605:E000::F:8F/128",
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
    ]
    parent_site_info = [
        {
            "CIRC_PATH_INST_ID": "2330803",
            "CIRCUIT_NAME": "92.L1XX.004050..CHTR",
            "CIRCUIT_STATUS": "Auto-Planned",
            "CIRCUIT_BANDWIDTH": "100 Mbps",
            "CIRCUIT_CATEGORY": "ETHERNET",
            "SERVICE_TYPE": "COM-DIA",
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "ORDER_NUM": "COM-FIA-097610,ENG-03367376",
            "ORDERED": "MAR 14, 2023",
            "IN_SERVICE": "MAR 25, 2023",
            "A_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_SITE_TYPE": "CUST_OFFNET",
            "A_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
            "A_SITE_REGION": "WEST",
            "A_ADDRESS": "3382 E GILA RIDGE RD",
            "A_CITY": "YUMA",
            "A_STATE": "AZ",
            "A_ZIP": "85365",
            "A_COMMENTS": "ENG-04168855\nCPE Fiber Installer\t\nJose E Morales\nAs Built Demarcation Location\t\n \nManaged Services Installer Type\t\n \nCPE Install Notes\t\n10/19-JM- Install complete. Cradleopint configured.\n\nCradlepoint location: 1st floor IT room, Wall mounted on backboard.",
            "A_CLLI": "YUMAAZQU",
            "A_NPA": "928",
            "A_LONGITUDE": "-114.575279",
            "A_LATITUDE": "32.686742",
            "Z_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "Z_SITE_TYPE": "CUST_OFFNET",
            "Z_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
            "Z_SITE_REGION": "WEST",
            "Z_ADDRESS": "3382 E GILA RIDGE RD",
            "Z_CITY": "YUMA",
            "Z_STATE": "AZ",
            "Z_ZIP": "85365",
            "Z_COMMENTS": "ENG-04168855\nCPE Fiber Installer\t\nJose E Morales\nAs Built Demarcation Location\t\n \nManaged Services Installer Type\t\n \nCPE Install Notes\t\n10/19-JM- Install complete. Cradleopint configured.\n\nCradlepoint location: 1st floor IT room, Wall mounted on backboard.",
            "Z_CLLI": "YUMAAZQU",
            "Z_NPA": "928",
            "Z_LONGITUDE": "-114.575279",
            "Z_LATITUDE": "32.686742",
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
        }
    ]
    shelf = "YUMAAZQU4ZW"
    bandwidth_string = "1 Gbps"
    expected_resp = ("92001.GE1.PHNHAZVA1CW.YUMAAZQU4ZW", "1 Gbps")

    monkeypatch.setattr(tp, "get_granite", lambda *args, **kwargs: path_elements)
    monkeypatch.setattr(tp, "get_circuit_site_info", lambda *args, **kwargs: parent_site_info)
    monkeypatch.setattr(tp, "get_next_zw_shelf", lambda *args, **kwargs: shelf)
    monkeypatch.setattr(tp, "bandwidth_conversion", lambda *args, **kwargs: bandwidth_string)

    assert tp.build_transport_path(cid, parent_site_info[0]["A_CLLI"]) == expected_resp


@pytest.mark.unittest
def test_build_transport_path_AbortExceptions(monkeypatch: pytest.MonkeyPatch):
    cid = "92.L1XX.004050..CHTR"
    path_elements = []
    parent_site_info = [
        {
            "CIRC_PATH_INST_ID": "2330803",
            "CIRCUIT_NAME": "92.L1XX.004050..CHTR",
            "CIRCUIT_STATUS": "Auto-Planned",
            "CIRCUIT_BANDWIDTH": "100 Mbps",
            "CIRCUIT_CATEGORY": "ETHERNET",
            "SERVICE_TYPE": "COM-DIA",
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "ORDER_NUM": "COM-FIA-097610,ENG-03367376",
            "ORDERED": "MAR 14, 2023",
            "IN_SERVICE": "MAR 25, 2023",
            "A_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_SITE_TYPE": "CUST_OFFNET",
            "A_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
            "A_SITE_REGION": "WEST",
            "A_ADDRESS": "3382 E GILA RIDGE RD",
            "A_CITY": "YUMA",
            "A_STATE": "AZ",
            "A_ZIP": "85365",
            "A_COMMENTS": "ENG-04168855\nCPE Fiber Installer\t\nJose E Morales\nAs Built Demarcation Location\t\n \nManaged Services Installer Type\t\n \nCPE Install Notes\t\n10/19-JM- Install complete. Cradleopint configured.\n\nCradlepoint location: 1st floor IT room, Wall mounted on backboard.",
            "A_CLLI": "YUMAAZQU",
            "A_NPA": "928",
            "A_LONGITUDE": "-114.575279",
            "A_LATITUDE": "32.686742",
            "Z_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "Z_SITE_TYPE": "CUST_OFFNET",
            "Z_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
            "Z_SITE_REGION": "WEST",
            "Z_ADDRESS": "3382 E GILA RIDGE RD",
            "Z_CITY": "YUMA",
            "Z_STATE": "AZ",
            "Z_ZIP": "85365",
            "Z_COMMENTS": "ENG-04168855\nCPE Fiber Installer\t\nJose E Morales\nAs Built Demarcation Location\t\n \nManaged Services Installer Type\t\n \nCPE Install Notes\t\n10/19-JM- Install complete. Cradleopint configured.\n\nCradlepoint location: 1st floor IT room, Wall mounted on backboard.",
            "Z_CLLI": "YUMAAZQU",
            "Z_NPA": "928",
            "Z_LONGITUDE": "-114.575279",
            "Z_LATITUDE": "32.686742",
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
        }
    ]
    shelf = "YUMAAZQU4ZW"
    bandwidth_string = "1 Gbps"
    resp = [
        {
            "SITE_INST_ID": "107581",
            "SITE_NAME": "YUMAAZQU-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "CLLI": "YUMAAZQU",
            "NPA_NXX": "602",
            "EQUIP_INST_ID": "503601",
            "EQUIP_NAME": "YUMAAZQU1CW/001.00D.004.01/RTR",
            "VENDOR": "JUNIPER",
            "MODEL": "MX240",
            "TYPE": "ROUTER",
            "FQDN": "YUMAAZQU1CW.CHTRSE.COM",
            "IP_ADDRESS": "24.43.180.244/32",
            "SLOT": "[0/2]/1",
            "SLOT_INST_ID": "11987292",
            "CARD_INST_ID": "7393565",
            "PORT_INST_ID": "110512655",
            "PORT_ACCESS_ID": "1/0/1",
            "BANDWIDTH": "1 Gbps",
            "PORT_STATUS": "Ok",
            "OPTIC": "GE",
            "OPTIC_TEMPLATE": "GENERIC SFP LEVEL 2",
        }
    ]

    monkeypatch.setattr(tp, "get_granite", lambda *args, **kwargs: next(resp_get))
    monkeypatch.setattr(tp, "get_circuit_site_info", lambda *args, **kwargs: parent_site_info)
    monkeypatch.setattr(tp, "get_next_zw_shelf", lambda *args, **kwargs: shelf)
    monkeypatch.setattr(tp, "bandwidth_conversion", lambda *args, **kwargs: bandwidth_string)

    # unable to determine A-side router - missing equipment name for A-side router
    r1 = deepcopy(resp)
    r1[0].pop("EQUIP_NAME")
    resp_get = iter([path_elements, r1])
    try:
        tp.build_transport_path(cid, parent_site_info[0]["A_CLLI"])
    except AbortException as e:
        assert e.code == 500
        assert f"Unable to determine A-side router at {r1[0]['CLLI']}" in e.data["message"]

    # unable to determine A-side router
    r1 = deepcopy(resp)
    r1 = r1[0]
    resp_get = iter([path_elements, r1])
    try:
        tp.build_transport_path(cid, parent_site_info[0]["A_CLLI"])
    except AbortException as e:
        assert e.code == 500
        assert f"Unable to determine A-side router at {r1['CLLI']}" in e.data["message"]


@pytest.mark.unittest
def test_bandwidth_conversion():
    bandwidth = "100 Mbps"
    expected = "1 Gbps"
    assert tp.bandwidth_conversion(bandwidth) == expected

    bandwidth = "20 Gbps"
    expected = "10 Gbps"
    assert tp.bandwidth_conversion(bandwidth) == expected


@pytest.mark.unittest
def test_get_bandwidth_in_mbps():
    bw_type, bw_value = "Mbps", "50"
    expected_mbps = 50
    assert tp.get_bandwidth_in_mbps(bw_type, bw_value) == expected_mbps

    bw_type, bw_value = "Gbps", "30"
    expected_mbps = 30000
    assert tp.get_bandwidth_in_mbps(bw_type, bw_value) == expected_mbps

    bw_type, bw_value = "Kbps", "100"
    try:
        tp.get_bandwidth_in_mbps(bw_type, bw_value)
    except AbortException as e:
        assert e.code == 500


@pytest.mark.unittest
def test_create_transport_path_at_granite(monkeypatch: pytest.MonkeyPatch):
    transport_path_name = "92001.GE1.PHNHAZVA1CW.YUMAAZQU4ZW"
    bandwidth_string = "1 Gbps"
    a_site_name = "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD"
    z_site_name = "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD"
    expected_resp = {
        "pathId": "92001.GE1.PHNHAZVA1CW.YUMAAZQU4ZW",
        "pathRev": "1",
        "status": "Auto-Planned",
        "pathInstanceId": "2638755",
        "retString": "Path Added",
    }

    monkeypatch.setattr(tp, "post_granite", lambda *args, **kwargs: expected_resp)

    assert tp._create_transport_path_at_granite(transport_path_name, bandwidth_string, a_site_name, z_site_name)


@pytest.mark.unittest
def test_reserve_segment_on_granite(monkeypatch: pytest.MonkeyPatch):
    transport_path_data = {
        "path_inst_id": "2638776",
        "leg_name": "1",
        "leg_inst_id": "3069985",
        "z_site_name": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
        "transport_path_name": "92002.GE1.PHNHAZVA1CW.YUMAAZQU4ZW",
    }
    segment_inst_id = "73576"
    resp = {
        "pathId": "92.L1XX.004050..CHTR",
        "pathRev": "1",
        "status": "Auto-Planned",
        "pathInstanceId": "2638776",
        "retString": "Path Updated",
    }

    monkeypatch.setattr(tp, "put_granite", lambda *args, **kwargs: resp)

    assert tp._reserve_segment_on_granite(transport_path_data, segment_inst_id) == resp


@pytest.mark.unittest
def test_sequence_number_for_new_service_path_element(monkeypatch: pytest.MonkeyPatch):
    cid = "92.L1XX.004050..CHTR"
    path_elements = [
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "YUMAAZQU",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "CUST_OFFNET",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Auto-Planned",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "1.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "1",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "ELEMENT_TYPE": "PATH",
            "ELEMENT_NAME": "60.KGFD.000001..TWCC",
            "ELEMENT_REFERENCE": "2511364",
            "ELEMENT_CATEGORY": "ETHERNET TRANSPORT",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": "2190296",
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977816",
            "SLOT": None,
            "PORT_NAME": None,
            "PORT_INST_ID": None,
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": None,
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": None,
            "VENDOR": None,
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": None,
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2330803",
            "PATH_NAME": "92.L1XX.004050..CHTR",
            "PATH_REV": "1",
            "PATH_CATEGORY": "ETHERNET",
            "PATH_A_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "PATH_Z_SITE": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_CLLI": "YUMAAZQU",
            "Z_CLLI": "YUMAAZQU",
            "PATH_A_SITE_TYPE": "CUST_OFFNET",
            "PATH_Z_SITE_TYPE": "CUST_OFFNET",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Auto-Planned",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "COM-DIA",
            "BANDWIDTH": "100 Mbps",
            "BW_SIZE": "100000000",
            "CUSTOMER_ID": "ACCT-04453113",
            "CUSTOMER_NAME": "RUSH ENTERPRISES-DIRECT NATIONAL",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": "76.80.207.16/29",
            "IPV4_ASSIGNED_GATEWAY": "76.80.207.17/29",
            "IPV4_SERVICE_TYPE": "LAN",
            "IPV6_GLUE_SUBNET": "2600:5C00:3800:412::/64",
            "IPV6_ASSIGNED_SUBNETS": "2600:5C00:F60A::/48",
            "IPV6_SERVICE_TYPE": "ROUTED",
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "2.",
            "PARENT_SEQUENCE": None,
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "2",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA1CW/001.00D.004.01/RTR",
            "ELEMENT_REFERENCE": "503601",
            "ELEMENT_CATEGORY": "ROUTER",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "100 Mbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": None,
            "CHAN_INST_ID": None,
            "SLOT": "[0/2]/1",
            "PORT_NAME": "1-54",
            "PORT_INST_ID": "116252119",
            "PORT_ACCESS_ID": None,
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": "DYNAMIC",
            "FQDN": "PHNHAZVA1CW.CHTRSE.COM",
            "MODEL": "MX240",
            "VENDOR": "JUNIPER",
            "TID": "PHNHAZVA1CW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "24.43.180.244/32",
            "IPV6_ADDRESS": "2605:E000::F:8F/128",
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "1",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "1..1.",
            "PARENT_SEQUENCE": "1",
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "1",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA1CW/001.00D.004.01/RTR",
            "ELEMENT_REFERENCE": "503601",
            "ELEMENT_CATEGORY": "ROUTER",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "10 Gbps",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977816",
            "SLOT": "[0/2]/1",
            "PORT_NAME": "1",
            "PORT_INST_ID": "114433805",
            "PORT_ACCESS_ID": "XE-1/2/1",
            "CONNECTOR_TYPE": "LC",
            "PORT_CHANNELIZATION": "DYNAMIC",
            "FQDN": "PHNHAZVA1CW.CHTRSE.COM",
            "MODEL": "MX240",
            "VENDOR": "JUNIPER",
            "TID": "PHNHAZVA1CW",
            "LEGACY_EQUIP_SOURCE": "L-TWC",
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": "24.43.180.244/32",
            "IPV6_ADDRESS": "2605:E000::F:8F/128",
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "2",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "1..2.",
            "PARENT_SEQUENCE": "1",
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "2",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA/001.00D.004.42/MMP FDP",
            "ELEMENT_REFERENCE": "504691",
            "ELEMENT_CATEGORY": "FDP",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "OPTICAL",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977816",
            "SLOT": "5",
            "PORT_NAME": "3",
            "PORT_INST_ID": "83466376",
            "PORT_ACCESS_ID": "27",
            "CONNECTOR_TYPE": "SC-UPC",
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": "ASBMMB1021480",
            "VENDOR": "ALL SYSTEMS BROADBAND",
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "2",
        },
        {
            "CIRC_PATH_INST_ID": "2511364",
            "PATH_NAME": "60.KGFD.000001..TWCC",
            "PATH_REV": "3",
            "PATH_CATEGORY": "ETHERNET TRANSPORT",
            "PATH_A_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "PATH_Z_SITE": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "A_CLLI": "PHNHAZVA",
            "Z_CLLI": "PHNHAZVA",
            "PATH_A_SITE_TYPE": "COLO",
            "PATH_Z_SITE_TYPE": "COLO",
            "TOPOLOGY": "Point-to-point",
            "PATH_STATUS": "Live",
            "CLASS_OF_SERVICE": None,
            "SLM_ELIGIBILITY": "INELIGIBLE DESIGN",
            "EVC_ID": None,
            "SERVICE_TYPE": "CUS-ENNI-BUY",
            "BANDWIDTH": "10 Gbps",
            "BW_SIZE": "10000000000",
            "CUSTOMER_ID": "ACCT-04797547",
            "CUSTOMER_NAME": "BUY NNI",
            "IPV4_GLUE_SUBNET": None,
            "IPV4_ASSIGNED_SUBNETS": None,
            "IPV4_ASSIGNED_GATEWAY": None,
            "IPV4_SERVICE_TYPE": None,
            "IPV6_GLUE_SUBNET": None,
            "IPV6_ASSIGNED_SUBNETS": None,
            "IPV6_SERVICE_TYPE": None,
            "CUSTOMER_TYPE": "ENTERPRISE",
            "ORDER_REFERENCE": "1..3.",
            "PARENT_SEQUENCE": "1",
            "PARENT_MEMBER_NBR": None,
            "SEQUENCE": "3",
            "MEMBER_NBR": None,
            "LEG_NAME": "1",
            "LEG_INST_ID": "2899815",
            "A_SITE_NAME": "PHNHAZVA-TWC/COLO-IRON MOUNTAIN/PHOENIX-615 N 48TH ST (ENT/ENT LEC)",
            "Z_SITE_NAME": None,
            "ELEMENT_TYPE": "PORT",
            "ELEMENT_NAME": "PHNHAZVA/001.00D.004.42/MMP FDP",
            "ELEMENT_REFERENCE": "504691",
            "ELEMENT_CATEGORY": "FDP",
            "ELEMENT_STATUS": "Live",
            "ELEMENT_BANDWIDTH": "OPTICAL",
            "NEXT_PATH_INST_ID": None,
            "PREV_PATH_INST_ID": None,
            "CHAN_NAME": "2",
            "CHAN_INST_ID": "10977816",
            "SLOT": "5",
            "PORT_NAME": "4",
            "PORT_INST_ID": "83466377",
            "PORT_ACCESS_ID": "28",
            "CONNECTOR_TYPE": "SC-UPC",
            "PORT_CHANNELIZATION": None,
            "FQDN": None,
            "MODEL": "ASBMMB1021480",
            "VENDOR": "ALL SYSTEMS BROADBAND",
            "TID": None,
            "LEGACY_EQUIP_SOURCE": None,
            "PURCHASING_GROUP": "ENTERPRISE",
            "IPV4_ADDRESS": None,
            "IPV6_ADDRESS": None,
            "C_VLAN": None,
            "CUST_S_VLAN": None,
            "S_VLAN": None,
            "VLAN_OPERATION": None,
            "PORT_ROLE": None,
            "INITIAL_PATH_NAME": "92.L1XX.004050..CHTR",
            "INITIAL_CIRCUIT_ID": "2330803",
            "LVL": "2",
        },
    ]
    resp = 4

    monkeypatch.setattr(tp, "get_path_elements", lambda *args, **kwargs: path_elements)

    assert tp.sequence_number_for_new_service_path_element(cid) == resp


@pytest.mark.unittest
def test_add_transport_channel_to_ethernet_path(monkeypatch: pytest.MonkeyPatch):
    cid = "92.L1XX.004050..CHTR"
    transport_path_inst_id = "2638776"
    new_sequence_number = 4
    res = [
        {
            "CIRC_PATH_INST_ID": "2330803",
            "CIRCUIT_NAME": "92.L1XX.004050..CHTR",
            "CIRCUIT_STATUS": "Auto-Planned",
            "CIRCUIT_BANDWIDTH": "100 Mbps",
            "CIRCUIT_CATEGORY": "ETHERNET",
            "SERVICE_TYPE": "COM-DIA",
            "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
            "ORDER_NUM": "COM-FIA-097610,ENG-03367376",
            "ORDERED": "MAR 14, 2023",
            "IN_SERVICE": "MAR 25, 2023",
            "A_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "A_SITE_TYPE": "CUST_OFFNET",
            "A_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
            "A_SITE_REGION": "WEST",
            "A_ADDRESS": "3382 E GILA RIDGE RD",
            "A_CITY": "YUMA",
            "A_STATE": "AZ",
            "A_ZIP": "85365",
            "A_COMMENTS": "ENG-04168855\nCPE Fiber Installer\t\nJose E Morales\nAs Built Demarcation Location\t\n \nManaged Services Installer Type\t\n \nCPE Install Notes\t\n10/19-JM- Install complete. Cradleopint configured.\n\nCradlepoint location: 1st floor IT room, Wall mounted on backboard.",
            "A_CLLI": "YUMAAZQU",
            "A_NPA": "928",
            "A_LONGITUDE": "-114.575279",
            "A_LATITUDE": "32.686742",
            "Z_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
            "Z_SITE_TYPE": "CUST_OFFNET",
            "Z_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
            "Z_SITE_REGION": "WEST",
            "Z_ADDRESS": "3382 E GILA RIDGE RD",
            "Z_CITY": "YUMA",
            "Z_STATE": "AZ",
            "Z_ZIP": "85365",
            "Z_COMMENTS": "ENG-04168855\nCPE Fiber Installer\t\nJose E Morales\nAs Built Demarcation Location\t\n \nManaged Services Installer Type\t\n \nCPE Install Notes\t\n10/19-JM- Install complete. Cradleopint configured.\n\nCradlepoint location: 1st floor IT room, Wall mounted on backboard.",
            "Z_CLLI": "YUMAAZQU",
            "Z_NPA": "928",
            "Z_LONGITUDE": "-114.575279",
            "Z_LATITUDE": "32.686742",
            "LEG_NAME": "1",
            "LEG_INST_ID": "2665424",
        }
    ]
    data = {
        "CIRC_PATH_INST_ID": "2330803",
        "CIRCUIT_NAME": "92.L1XX.004050..CHTR",
        "CIRCUIT_STATUS": "Auto-Planned",
        "CIRCUIT_BANDWIDTH": "100 Mbps",
        "CIRCUIT_CATEGORY": "ETHERNET",
        "SERVICE_TYPE": "COM-DIA",
        "SLM_ELIGIBILITY": "ELIGIBLE DESIGN",
        "ORDER_NUM": "COM-FIA-097610,ENG-03367376",
        "ORDERED": "MAR 14, 2023",
        "IN_SERVICE": "MAR 25, 2023",
        "A_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
        "A_SITE_TYPE": "CUST_OFFNET",
        "A_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
        "A_SITE_REGION": "WEST",
        "A_ADDRESS": "3382 E GILA RIDGE RD",
        "A_CITY": "YUMA",
        "A_STATE": "AZ",
        "A_ZIP": "85365",
        "A_COMMENTS": "ENG-04168855\nCPE Fiber Installer\t\nJose E Morales\nAs Built Demarcation Location\t\n \nManaged Services Installer Type\t\n \nCPE Install Notes\t\n10/19-JM- Install complete. Cradleopint configured.\n\nCradlepoint location: 1st floor IT room, Wall mounted on backboard.",
        "A_CLLI": "YUMAAZQU",
        "A_NPA": "928",
        "A_LONGITUDE": "-114.575279",
        "A_LATITUDE": "32.686742",
        "Z_SITE_NAME": "YUMAAZQU-RUSH ENTERPRISES DIRECT//3382 E GILA RIDGE RD",
        "Z_SITE_TYPE": "CUST_OFFNET",
        "Z_SITE_MARKET": "SOUTHERN CALIFORNIA SOUTH",
        "Z_SITE_REGION": "WEST",
        "Z_ADDRESS": "3382 E GILA RIDGE RD",
        "Z_CITY": "YUMA",
        "Z_STATE": "AZ",
        "Z_ZIP": "85365",
        "Z_COMMENTS": "ENG-04168855\nCPE Fiber Installer\t\nJose E Morales\nAs Built Demarcation Location\t\n \nManaged Services Installer Type\t\n \nCPE Install Notes\t\n10/19-JM- Install complete. Cradleopint configured.\n\nCradlepoint location: 1st floor IT room, Wall mounted on backboard.",
        "Z_CLLI": "YUMAAZQU",
        "Z_NPA": "928",
        "Z_LONGITUDE": "-114.575279",
        "Z_LATITUDE": "32.686742",
        "LEG_NAME": "1",
        "LEG_INST_ID": "2665424",
    }
    granite_response_data = {
        "pathId": "92.L1XX.004050..CHTR",
        "pathRev": "1",
        "status": "Auto-Planned",
        "pathInstanceId": "2330803",
        "retString": "Path Updated",
    }

    monkeypatch.setattr(tp, "get_granite", lambda *args, **kwargs: res)
    monkeypatch.setattr(tp, "put_granite", lambda *args, **kwargs: granite_response_data)

    assert tp._add_transport_channel_to_ethernet_path(cid, transport_path_inst_id, new_sequence_number) == data
