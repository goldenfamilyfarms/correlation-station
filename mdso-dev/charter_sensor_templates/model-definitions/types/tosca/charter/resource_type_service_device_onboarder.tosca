"$schema"   = "http://cyaninc.com/json-schemas/tosca-lite-v1/definition-module#"
title       = "Service Device Onboarder"
package     = charter
version     = "1.0"
description = """
This document defines the the Service Device Onboarder action that will onboard devices
associated with a NetworkService that is not currently onboard.
"""
authors     = [ "Matt Becker (mbecker@ciena.com)" ]

imports {

}

resourceTypes { 
    ServiceDeviceOnboarder {
        derivedFrom = charter.resourceTypes.BaseResource
        title = Service Device Onboarder
        description = """
        - Extended from charter.resourceTypes.BaseResource 
        - This resource will onboard the missing devices referred in the CircuitDetails.
          Based on the context it will only on-board either the PEs or the CPEs..
            - Today only CPE supported.
        """

        properties {
        
            circuit_details_id {
                title = "Circuit Details ID"
                description = "ID for the circuit details created from the Granite system"
                type = string
                optional = false
                updatable = false
            }
            
            context {
                title = "Context"
                description = "Context"
                type = string
                updatable = false
                default = "CPE"
                enum = [
                    "CPE",
                    "PE",
                    "ALL"
                ]
            }

            operation {
                title = "Operation from which this CircuitDetailsCollector was invoked"
                description = """
                This property influences the CircuitDetailsCollector's behavior when choosing which
                nodes to configure.
                """
                optional = true
                updatable = false
                type = string
                default = "NETWORK_SERVICE_ACTIVATION"
                enum = [
                    "NETWORK_SERVICE_UPDATE",
                    "NETWORK_SERVICE_DELETION",
                    "NETWORK_SERVICE_ACTIVATION",
                    "CPE_ACTIVATION",
                    "SERVICE_MAPPER",
                    "SLM",
                    "CONFIG_MODELER",
                    "DISCONNECT_MAPPER",
                    "TRANSPORT",
                    "SMOKE_TEST",
                    "DEVICE_RESET"
                ]
            }

        }

        requirements {
    
        }
    
        capabilities {
    
        }

    }
}

serviceTemplates {

    ServiceDeviceOnboarder {
        title = Service Device Onboarder
        description = "Service Device Onboarder"
        implements = charter.resourceTypes.ServiceDeviceOnboarder
        
        plans {

            activate {
                type = remote
                language = python
                path = "scripts.networkservice.servicedeviceonboarder.Activate"
            }
            
        }
    }
}
